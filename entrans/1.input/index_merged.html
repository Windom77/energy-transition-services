<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EnTrans Input Form - Enhanced with FCAS Integration &amp; Dashboard</title>

    <!-- Bootstrap 5.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="data:,">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">

    <style>
        /* Enhanced custom styles with restoration support */
        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .loading-spinner {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Tab content animation */
        .tab-pane {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }

        .tab-pane.active {
            opacity: 1;
            transform: translateY(0);
        }

        /* Dashboard integration styles */
        .dashboard-badge {
            background: linear-gradient(45deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .dashboard-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            color: white;
            text-decoration: none;
        }

        .dashboard-badge.disabled {
            background: #6b7280;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Form restoration indicator */
        .restoration-badge {
            background: linear-gradient(45deg, #f59e0b, #d97706);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 0.25rem 0.75rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* Analysis progress indicator */
        .analysis-progress {
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 10px;
            padding: 1rem;
            color: white;
            margin: 1rem 0;
            display: none;
        }

        .analysis-progress.show {
            display: block;
        }

        /* Success notification with dashboard link */
        .success-with-dashboard {
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            color: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        /* Form validation styles */
        .was-validated .form-control:valid {
            border-color: #10b981;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%2310b981' d='m2.3 6.73.5-.4 1.4-1.4c.2-.2.5-.2.7 0s.2.5 0 .7l-2 2c-.2.2-.5.2-.7 0l-1-1c-.2-.2-.2-.5 0-.7s.5-.2.7 0l.4.4z'/%3e%3c/svg%3e");
        }

        .was-validated .form-control:invalid {
            border-color: #ef4444;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23ef4444'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath d='m5.8 4.6 2.4 2.4m0-2.4L5.8 7'/%3e%3c/svg%3e");
        }

        /* FCAS indicator styles */
        .fcas-status {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .fcas-status.enabled {
            background-color: #d1fae5;
            color: #065f46;
        }

        .fcas-status.disabled {
            background-color: #f3f4f6;
            color: #6b7280;
        }

        /* Revenue display animation */
        .revenue-counter {
            transition: all 0.5s ease;
        }

        .revenue-counter.updating {
            opacity: 0.6;
            transform: scale(0.95);
        }

        /* Load Data specific styles */
        .load-section {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 1px solid #f59e0b;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .load-method-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .load-method-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }

        .load-method-card.selected {
            border-color: #10b981;
            background: linear-gradient(135deg, #ecfdf5, #d1fae5);
        }

        .load-method-card .method-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            background: #f9fafb;
            transition: all 0.3s ease;
        }

        .upload-area.drag-over {
            border-color: #3b82f6;
            background: #eff6ff;
        }

        .upload-progress {
            background: #f3f4f6;
            border-radius: 4px;
            height: 8px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .upload-progress-bar {
            background: linear-gradient(90deg, #10b981, #059669);
            height: 100%;
            transition: width 0.3s ease;
        }

        .monthly-input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .month-input-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 1rem;
        }

        .load-validation-result {
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .load-validation-result.success {
            background: #ecfdf5;
            border: 1px solid #10b981;
            color: #065f46;
        }

        .load-validation-result.error {
            background: #fef2f2;
            border: 1px solid #ef4444;
            color: #991b1b;
        }

        .load-chart-container {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            height: 300px;
        }
    </style>
<style>
        .dashboard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        .form-card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
        }
        .form-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .nav-tabs-custom {
            border-bottom: 2px solid #e2e8f0;
            margin-bottom: 2rem;
        }
        .nav-tabs-custom .nav-link {
            border: none;
            color: #718096;
            font-weight: 500;
            padding: 1rem 1.5rem;
            border-radius: 10px 10px 0 0;
            margin-right: 0.5rem;
            transition: all 0.3s ease;
        }
        .nav-tabs-custom .nav-link:hover {
            background-color: #f8f9fa;
            color: #667eea;
        }
        .nav-tabs-custom .nav-link.active {
            background: linear-gradient(135deg, #667eea, #764ba2) !important;
            color: white !important;
            border: none;
        }
        .form-control {
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 0.75rem 1rem;
            transition: all 0.3s ease;
        }
        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            outline: none;
        }
        .progress-indicator {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
            z-index: 1000;
        }
        .address-section {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            border: 1px solid #bae6fd;
        }
        .subsection-header {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            border-left: 4px solid #667eea;
            padding: 1rem 1.5rem;
            margin: 1.5rem 0 1rem 0;
            border-radius: 0 8px 8px 0;
        }
        .subsection-header h4 {
            margin: 0;
            color: #2d3748;
            font-size: 1.1rem;
            font-weight: 600;
        }
        #map {
            height: 300px;
            width: 100%;
            border-radius: 8px;
            border: 2px solid #e2e8f0;
            margin-top: 1rem;
            background-color: #f0f0f0;
        }

        /* Tariff-specific styles */
        .tariff-section {
            background: linear-gradient(135deg, #fff5e6, #fff0db);
            border: 1px solid #ffd6a5;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        .tou-schedule-grid {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .tou-period-row {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 0.75rem;
            margin: 0.5rem 0;
        }
        .demand-charge-section {
            background: linear-gradient(135deg, #fef5e7, #fdf2e9);
            border: 1px solid #fed7aa;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .rate-input-group {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
        }

        /* FCAS-specific styles */
        .fcas-section {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border: 1px solid #7dd3fc;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        .fcas-service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        .fcas-service-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
        }
        .fcas-service-card.enabled {
            border-color: #10b981;
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
        }
        .fcas-auto-config {
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
            border: 1px solid #fbbf24;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .fcas-revenue-estimate {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border: 1px solid #10b981;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
        }

        /* Load Data specific styles */
        .load-section {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 1px solid #f59e0b;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        .load-method-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .load-method-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }
        .load-method-card.selected {
            border-color: #10b981;
            background: linear-gradient(135deg, #ecfdf5, #d1fae5);
        }
        .load-method-card .method-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        .upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            background: #f9fafb;
            transition: all 0.3s ease;
        }
        .upload-area.drag-over {
            border-color: #3b82f6;
            background: #eff6ff;
        }
        .upload-progress {
            background: #f3f4f6;
            border-radius: 4px;
            height: 8px;
            overflow: hidden;
            margin: 1rem 0;
        }
        .upload-progress-bar {
            background: linear-gradient(90deg, #10b981, #059669);
            height: 100%;
            transition: width 0.3s ease;
        }
        .monthly-input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        .month-input-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 1rem;
        }
        .load-validation-result {
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .load-validation-result.success {
            background: #ecfdf5;
            border: 1px solid #10b981;
            color: #065f46;
        }
        .load-validation-result.error {
            background: #fef2f2;
            border: 1px solid #ef4444;
            color: #991b1b;
        }
        .load-chart-container {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            height: 300px;
        }
        .spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style></head>

<body class="bg-light">
    <!-- Enhanced Header with FCAS Status, Dashboard Link, and Restoration Support -->
    <header class="hero-gradient shadow-sm">
        <div class="container py-4">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h1 class="text-white mb-2 fw-bold">
                        <i class="fas fa-solar-panel me-3"></i>
                        EnTrans Input Form
                        
                    </h1>
                    <p class="text-white-50 mb-0 fs-6">
                        
                        Enhanced Interface with ML-Based FCAS Revenue Forecasting
                        
                    </p>
                </div>
                <div class="col-md-6">
                    <div class="d-flex justify-content-end align-items-center flex-wrap gap-2">
                        

                        <!-- Dashboard Navigation Badge -->
                        <a href="/dashboard/" class="dashboard-badge" id="dashboard-link">
                            <i class="fas fa-chart-line"></i>
                            <span>Results Dashboard</span>
                        </a>

                        <div class="fcas-status disabled" id="header-fcas-status"><i class="fas fa-bolt me-1"></i><span>FCAS Disabled</span></div>
                        <div class="text-white-50 small">
                            <i class="fas fa-shield-alt me-1"></i>
                            Secure
                        </div>
                        <div class="text-white-50 small">
                            <i class="fas fa-clock me-1"></i>
                            Auto-Save
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Form Restoration Success Alert -->
    

    <!-- SIMPLIFIED Analysis Progress Indicator - NO PERCENTAGES -->
    <div class="container">
        <div class="analysis-progress" id="analysis-progress">
            <div class="d-flex align-items-center">
                <div class="loading-spinner me-3"></div>
                <div class="flex-grow-1">
                    <div class="fw-bold" id="progress-title">Running Analysis...</div>
                    <div class="small opacity-75" id="progress-message">Please wait while we process your configuration</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container my-5">
        <!-- Form Container -->
        <form id="analysis-form" method="POST" action="/run-analysis" class="needs-validation" novalidate="">

            <!-- Dynamic Form Root - Tabs will be injected here -->
            <div id="dynamic-form-root" class="mb-5"><ul class="nav nav-tabs nav-tabs-custom mb-4"><li class="nav-item"><a class="nav-link" href="#project-information" data-tab="project-information"><i class="fas fa-building me-2"></i>Project Information</a></li><li class="nav-item"><a class="nav-link" href="#pv-configuration" data-tab="pv-configuration"><i class="fas fa-solar-panel me-2"></i>PV Configuration</a></li><li class="nav-item"><a class="nav-link" href="#battery-storage" data-tab="battery-storage"><i class="fas fa-battery-three-quarters me-2"></i>Battery Storage</a></li><li class="nav-item"><a class="nav-link" href="#network-configuration" data-tab="network-configuration"><i class="fas fa-plug me-2"></i>Network Configuration</a></li><li class="nav-item"><a class="nav-link" href="#financial-parameters" data-tab="financial-parameters"><i class="fas fa-dollar-sign me-2"></i>Financial Parameters</a></li><li class="nav-item"><a class="nav-link" href="#project-costs" data-tab="project-costs"><i class="fas fa-calculator me-2"></i>Project Costs</a></li><li class="nav-item"><a class="nav-link active" href="#load" data-tab="load"><i class="fas fa-chart-line me-2"></i>Load</a></li></ul><div class="tab-content"><div class="tab-pane fade" id="project-information"><div class="form-card p-4"><h3 class="mb-4"><i class="fas fa-building me-2 text-primary"></i>Project Information</h3>
        <div class="address-section">
            <div class="subsection-header">
                <h4><i class="fas fa-map-marker-alt me-2"></i>Project Location</h4>
            </div>
            <div class="row g-3">
                <div class="col-md-8">
                    <label for="project-address" class="form-label">Project Address</label>
                    <input type="text" class="form-control" id="project-address" placeholder="Enter full project address" value="4005">
                </div>
                <div class="col-md-4">
                    <label class="form-label">&nbsp;</label>
                    <button type="button" class="btn btn-primary w-100" id="geocode-btn"><i class="fas fa-search-location me-2"></i>Locate</button>
                </div>
                <div class="col-12">
                    <div id="map" class="leaflet-container leaflet-touch leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom" style="position: relative;" tabindex="0"><div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(0px, 0px, 0px);"><div class="leaflet-pane leaflet-tile-pane"><div class="leaflet-layer " style="z-index: 1; opacity: 1;"><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate3d(0px, 0px, 0px) scale(1);"><img alt="" src="https://c.tile.openstreetmap.org/13/7578/4745.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(433px, -195px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/13/7578/4746.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(433px, 61px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/13/7577/4745.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(177px, -195px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/13/7579/4745.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(689px, -195px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/13/7577/4746.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(177px, 61px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/13/7579/4746.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(689px, 61px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/13/7576/4745.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-79px, -195px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/13/7580/4745.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(945px, -195px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/13/7576/4746.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-79px, 61px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/13/7580/4746.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(945px, 61px, 0px); opacity: 1;"></div></div></div><div class="leaflet-pane leaflet-overlay-pane"></div><div class="leaflet-pane leaflet-shadow-pane"><img src="https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png" class="leaflet-marker-shadow leaflet-zoom-animated" style="margin-left: -12px; margin-top: -41px; width: 41px; height: 41px; transform: translate3d(597px, 148px, 0px);" alt=""></div><div class="leaflet-pane leaflet-marker-pane"><img src="https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png" class="leaflet-marker-icon leaflet-zoom-animated leaflet-interactive" style="margin-left: -12px; margin-top: -41px; width: 25px; height: 41px; transform: translate3d(597px, 148px, 0px); z-index: 148;" alt="Marker" tabindex="0" role="button"></div><div class="leaflet-pane leaflet-tooltip-pane"></div><div class="leaflet-pane leaflet-popup-pane"></div><div class="leaflet-proxy leaflet-zoom-animated" style="transform: translate3d(1940130px, 1215060px, 0px) scale(4096);"></div></div><div class="leaflet-control-container"><div class="leaflet-top leaflet-left"><div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in" href="#" title="Zoom in" role="button" aria-label="Zoom in" aria-disabled="false"><span aria-hidden="true">+</span></a><a class="leaflet-control-zoom-out" href="#" title="Zoom out" role="button" aria-label="Zoom out" aria-disabled="false"><span aria-hidden="true">‚àí</span></a></div></div><div class="leaflet-top leaflet-right"></div><div class="leaflet-bottom leaflet-left"></div><div class="leaflet-bottom leaflet-right"><div class="leaflet-control-attribution leaflet-control"><a href="https://leafletjs.com" title="A JavaScript library for interactive maps"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"></path><path fill="#FFD500" d="M0 4h12v3H0z"></path><path fill="#E0BC00" d="M0 7h12v1H0z"></path></svg> Leaflet</a> <span aria-hidden="true">|</span> ¬© OpenStreetMap contributors</div></div></div></div>
                </div>
                <div class="col-md-6">
                    <label for="latitude" class="form-label">Latitude</label>
                    <input type="number" class="form-control" id="latitude" data-pysam-module="site" data-pysam-key="lat" min="-90" max="90" step="any" required="" value="-27.4630815">
                </div>
                <div class="col-md-6">
                    <label for="longitude" class="form-label">Longitude</label>
                    <input type="number" class="form-control" id="longitude" data-pysam-module="site" data-pysam-key="lon" min="-180" max="180" step="any" required="" value="153.0456599">
                </div>
            </div>
        </div>
    <div class="subsection-header mt-4"><h4><i class="fas fa-info-circle me-2"></i>Project Details</h4></div><div class="row"><div class="col-md-6"><div class="mb-3"><label for="project_owner" class="form-label">Project Owner</label><input type="text" class="form-control" id="project_owner" data-pysam-key="project_owner" value="Consultant 1"><div class="form-text text-muted small">Name of entity considering the project</div></div></div><div class="col-md-6"><div class="mb-3"><label for="project_date_eval" class="form-label">Project Evaluation Date</label><input type="date" class="form-control" id="project_date_eval" data-pysam-key="project_date_eval" value="2025-09-03"><div class="form-text text-muted small">Date of evaluation</div></div></div><div class="col-md-6"><div class="mb-3"><label for="project_id" class="form-label">Project ID</label><input type="text" class="form-control" id="project_id" data-pysam-key="project_id" value="123456B"><div class="form-text text-muted small">Identifying number or reference</div></div></div><div class="col-md-6"><div class="mb-3"><label for="project_desc" class="form-label">Project Description</label><input type="text" class="form-control" id="project_desc" data-pysam-key="project_desc" value="Solar &amp; Battery Project #1"><div class="form-text text-muted small">Brief outline of the project</div></div></div><div class="col-md-6"><div class="mb-3"><label for="analysis_period" class="form-label">Project Lifetime (years)</label><input type="number" class="form-control" id="analysis_period" data-pysam-key="analysis_period" data-pysam-module="Cashloan" min="1" max="50" value="25"><div class="form-text text-muted small">Length of financial analysis period</div></div></div><div class="col-md-6"><div class="mb-3"><label for="tz" class="form-label">Project Timezone</label><select class="form-control" id="tz" data-pysam-key="tz" data-pysam-module="UtilityRate5" value=""><option value="" selected="selected">-- Select --</option><option value="AEST">AEST</option><option value="ACST">ACST</option><option value="AWST">AWST</option></select></div></div><div class="col-md-6"><div class="mb-3"><label for="project_evaluator" class="form-label">Project Evaluator</label><input type="text" class="form-control" id="project_evaluator" data-pysam-key="project_evaluator" value="ETC pty ltd"><div class="form-text text-muted small">Name of Project Evaluator</div></div></div><div class="col-md-6"><div class="mb-3"><label for="project_evaluator_contact" class="form-label">Project Evaluator Contacts</label><input type="text" class="form-control" id="project_evaluator_contact" data-pysam-key="project_evaluator_contact" value="1234567"><div class="form-text text-muted small">Phone and email of Project Evaluator</div></div></div></div></div></div><div class="tab-pane fade" id="pv-configuration"><div class="form-card p-4"><h3 class="mb-4"><i class="fas fa-solar-panel me-2 text-primary"></i>PV Configuration</h3><div class="row"><div class="col-md-6"><div class="mb-3"><label for="system_capacity" class="form-label">New System Size (kW)</label><input type="number" class="form-control" id="system_capacity" data-pysam-key="system_capacity" data-pysam-module="Pvsamv1" min="0" value="1001"><div class="form-text text-muted small">Project Solar install</div></div></div><div class="col-md-6"><div class="mb-3"><label for="land_area" class="form-label">Land area (acres)</label><input type="number" class="form-control" id="land_area" data-pysam-key="land_area" data-pysam-module="Pvsamv1" step="0.01" min="0" value=""><div class="form-text text-muted small">Allocated land area</div></div></div><div class="col-md-6"><div class="mb-3"><label for="roof_space" class="form-label">Roof space (m2)</label><input type="number" class="form-control" id="roof_space" data-pysam-key="roof_space" data-pysam-module="Pvsamv1" step="0.01" min="0" value=""><div class="form-text text-muted small">Usable roof space</div></div></div><div class="col-md-6"><div class="mb-3"><label for="subarray1_tilt" class="form-label">Tilt (degrees)</label><input type="number" class="form-control" id="subarray1_tilt" data-pysam-key="subarray1_tilt" data-pysam-module="Pvsamv1" step="0.01" min="0" max="90" value="20"><div class="form-text text-muted small">Tilt angle of PV panels</div></div></div><div class="col-md-6"><div class="mb-3"><label for="subarray1_azimuth" class="form-label">Azimuth (degrees)</label><input type="number" class="form-control" id="subarray1_azimuth" data-pysam-key="subarray1_azimuth" data-pysam-module="Pvsamv1" step="0.01" min="0" max="359" value="0"><div class="form-text text-muted small">Orientation of PV array</div></div></div><div class="col-md-6"><div class="mb-3"><label for="inv_snl_eff_cec" class="form-label">Inverter Efficiency (%)</label><div class="input-group"><input type="number" class="form-control" id="inv_snl_eff_cec" data-pysam-key="inv_snl_eff_cec" data-pysam-module="Pvsamv1" step="0.1" min="0" max="100" value="98.7"><span class="input-group-text">%</span></div><div class="form-text text-muted small">Inverter efficiency</div></div></div><div class="col-md-6"><div class="mb-3"><label for="dc_degradation" class="form-label">Degradation Rate (%)</label><div class="input-group"><input type="number" class="form-control" id="dc_degradation" data-pysam-key="dc_degradation" data-pysam-module="Pvsamv1" step="0.1" min="0" max="100" value="0.5"><span class="input-group-text">%</span></div><div class="form-text text-muted small">Annual degradation rate of PV system</div></div></div><div class="col-md-6"><div class="mb-3"><label for="subarray1_dcwiring_loss" class="form-label">DCWiring Losses (%)</label><div class="input-group"><input type="number" class="form-control" id="subarray1_dcwiring_loss" data-pysam-key="subarray1_dcwiring_loss" data-pysam-module="Pvsamv1" step="0.1" min="0" max="100" value="2"><span class="input-group-text">%</span></div><div class="form-text text-muted small">DCWiring Losses (%)</div></div></div></div></div></div><div class="tab-pane fade" id="battery-storage"><div class="form-card p-4"><h3 class="mb-4"><i class="fas fa-battery-three-quarters me-2 text-primary"></i>Battery Storage</h3><div class="row"><div class="col-md-6"><div class="mb-3"><label for="en_batt" class="form-label">Include storage?</label><select class="form-control" id="en_batt" data-pysam-key="en_batt" data-pysam-module="Pvsamv1" value="yes"><option value="">-- Select --</option><option value="yes" selected="selected">yes</option><option value="no">no</option></select></div></div><div class="col-md-6"><div class="mb-3"><label for="batt_computed_bank_capacity" class="form-label">Battery Energy Capacity (kWh)</label><input type="number" class="form-control" id="batt_computed_bank_capacity" data-pysam-key="batt_computed_bank_capacity" data-pysam-module="Pvsamv1" step="0.01" min="0" value="1200"><div class="form-text text-muted small">Energy capacity of battery</div></div></div><div class="col-md-6"><div class="mb-3"><label for="batt_power_charge_max_kwac" class="form-label">Maximum Charge Rate (C-rate)</label><input type="number" class="form-control" id="batt_power_charge_max_kwac" data-pysam-key="batt_power_charge_max_kwac" data-pysam-module="Pvsamv1" step="0.01" min="0" value="300"><div class="form-text text-muted small">Max charge rate relative to capacity</div></div></div><div class="col-md-6"><div class="mb-3"><label for="batt_power_discharge_max_kwac" class="form-label">Maximum Discharge Rate (C-rate)</label><input type="number" class="form-control" id="batt_power_discharge_max_kwac" data-pysam-key="batt_power_discharge_max_kwac" data-pysam-module="Pvsamv1" step="0.01" min="0" value="300"><div class="form-text text-muted small">Max discharge rate relative to capacity</div></div></div><div class="col-md-6"><div class="mb-3"><label for="batt_ac_dc_efficiency" class="form-label">Battery Roundtrip Efficiency (%)</label><div class="input-group"><input type="number" class="form-control" id="batt_ac_dc_efficiency" data-pysam-key="batt_ac_dc_efficiency" data-pysam-module="Pvsamv1" step="0.1" min="0" max="100" value="96"><span class="input-group-text">%</span></div><div class="form-text text-muted small">Battery roundtrip efficiency</div></div></div><div class="col-md-6"><div class="mb-3"><label for="batt_minimum_SOC" class="form-label">Battery Depth of Discharge min (%)</label><div class="input-group"><input type="number" class="form-control" id="batt_minimum_SOC" data-pysam-key="batt_minimum_SOC" data-pysam-module="Pvsamv1" step="0.1" min="0" max="100" value="30"><span class="input-group-text">%</span></div><div class="form-text text-muted small">Usable depth of discharge (max/min SOC limits)</div></div></div><div class="col-md-6"><div class="mb-3"><label for="batt_maximum_SOC" class="form-label">Battery Depth of Discharge max (%)</label><div class="input-group"><input type="number" class="form-control" id="batt_maximum_SOC" data-pysam-key="batt_maximum_SOC" data-pysam-module="Pvsamv1" step="0.1" min="0" max="100" value="95"><span class="input-group-text">%</span></div><div class="form-text text-muted small">Usable depth of discharge (max/min SOC limits)</div></div></div><div class="col-md-6"><div class="mb-3"><label for="batt_calendar_choice" class="form-label">Battery Degradation Model</label><select class="form-control" id="batt_calendar_choice" data-pysam-key="batt_calendar_choice" data-pysam-module="Pvsamv1" value=""><option value="" selected="selected">-- Select --</option><option value="0=No Calendar Degradation">0=No Calendar Degradation</option><option value="1=Lithium Ion Model">1=Lithium Ion Model</option><option value="2=Input Loss Table">2=Input Loss Table</option></select></div></div><div class="col-md-6"><div class="mb-3"><label for="batt_dispatch_choice" class="form-label fw-semibold">Battery Dispatch Strategy</label><select class="form-control" id="batt_dispatch_choice" data-pysam-key="batt_dispatch_choice" data-pysam-module="Pvsamv1" onchange="updateBatteryDispatchDescription(this.value)" value="4"><option value="0">üìä Peak Shaving</option><option value="4" selected="selected">‚ö° Smart Energy Trading (Recommended) (Recommended)</option><option value="5">üè† Self Consumption</option></select>
        <div class="mt-3 p-3 bg-light rounded" id="battery-dispatch-description">
            <div class="d-flex align-items-start">
                <div class="me-3">
                    <span class="fs-4" id="dispatch-icon">‚ö°</span>
                </div>
                <div class="flex-grow-1">
                    <h6 class="mb-1" id="dispatch-name">Smart Energy Trading (Recommended)</h6>
                    <p class="mb-0 text-muted small" id="dispatch-desc">
                        Optimizes time-of-use arbitrage + FCAS revenue automatically
                    </p>
                </div>
            </div>
        </div>
    </div></div></div></div></div><div class="tab-pane fade" id="network-configuration"><div class="form-card p-4"><h3 class="mb-4"><i class="fas fa-plug me-2 text-primary"></i>Network Configuration</h3>
        <div class="tariff-section" id="tariff-config-container">
            <div class="subsection-header">
                <h4><i class="fas fa-plug me-2"></i>Network Tariff Configuration</h4>
            </div>
            <div id="tariff-controls" class="space-y-6">
        <div class="mb-4">
            <label for="tariff-type-select" class="form-label fw-semibold">Tariff Type</label>
            <select id="tariff-type-select" class="form-control" value="Flat">
                <option value="Flat" selected="selected">Flat Rate</option>
                <option value="TOU">Time-of-Use (TOU)</option>
            </select>
        </div>
    <div class="row g-3 mb-4">
        <div class="col-md-6">
            <label for="monthly-fixed-charge" class="form-label fw-semibold">
                Monthly Fixed Charge ($)
            </label>
            <input type="number" id="monthly-fixed-charge" value="10.00" step="0.01" min="0" class="form-control">
        </div>
        <div class="col-md-6">
            <label for="feed-in-tariff" class="form-label fw-semibold">
                Feed-in Tariff ($/kWh)
            </label>
            <input type="number" id="feed-in-tariff" value="0.05" step="0.0001" min="0" class="form-control">
        </div>
    </div></div>
            <div id="tariff-config-details" class="space-y-6">
        <div class="rate-input-group">
            <h5 class="mb-3"><i class="fas fa-dollar-sign me-2"></i>Flat Rate Configuration</h5>
            <div class="row g-3">
                <div class="col-md-6">
                    <label for="flat-rate" class="form-label fw-semibold">
                        Energy Rate ($/kWh)
                    </label>
                    <input type="number" id="flat-rate" value="0.12" step="0.0001" min="0" class="form-control">
                </div>
            </div>
        </div>
    </div>
        <input type="hidden" id="monthly_fixed_charge" data-pysam-module="UtilityRate5" data-pysam-key="monthly_fixed_charge" value=""><input type="hidden" id="ur_ec_sched_weekday" data-pysam-module="UtilityRate5" data-pysam-key="ur_ec_sched_weekday" value=""><input type="hidden" id="ur_ec_sched_weekend" data-pysam-module="UtilityRate5" data-pysam-key="ur_ec_sched_weekend" value=""><input type="hidden" id="ur_ec_tou_mat" data-pysam-module="UtilityRate5" data-pysam-key="ur_ec_tou_mat" value=""><input type="hidden" id="ur_dc_flat_mat" data-pysam-module="UtilityRate5" data-pysam-key="ur_dc_flat_mat" value=""><input type="hidden" id="ur_ec_export_mat" data-pysam-module="UtilityRate5" data-pysam-key="ur_ec_export_mat" value=""></div>
    </div></div><div class="tab-pane fade" id="financial-parameters"><div class="form-card p-4"><h3 class="mb-4"><i class="fas fa-dollar-sign me-2 text-primary"></i>Financial Parameters</h3><div class="row"><div class="col-md-6"><div class="mb-3"><label for="inflation_rate" class="form-label">Inflation Rate (%)</label><div class="input-group"><input type="number" class="form-control" id="inflation_rate" data-pysam-key="inflation_rate" data-pysam-module="Cashloan" step="0.1" min="0" max="100" value="2.5"><span class="input-group-text">%</span></div><div class="form-text text-muted small">General inflation rate applied to O&amp;M costs</div></div></div><div class="col-md-6"><div class="mb-3"><label for="real_discount_rate" class="form-label">Discount Rate (%) (real)</label><div class="input-group"><input type="number" class="form-control" id="real_discount_rate" data-pysam-key="real_discount_rate" data-pysam-module="Cashloan" step="0.1" min="0" max="100" value="7"><span class="input-group-text">%</span></div><div class="form-text text-muted small">Discount rate for NPV calculations</div></div></div><div class="col-md-6"><div class="mb-3"><label for="federal_tax_rate" class="form-label">Tax Rate %</label><div class="input-group"><input type="number" class="form-control" id="federal_tax_rate" data-pysam-key="federal_tax_rate" data-pysam-module="Cashloan" step="0.1" min="0" max="100" value="25"><span class="input-group-text">%</span></div><div class="form-text text-muted small">Corporate taxation rate</div></div></div><div class="col-md-6"><div class="mb-3"><label for="debt_fraction" class="form-label">Debt Fraction (%)</label><div class="input-group"><input type="number" class="form-control" id="debt_fraction" data-pysam-key="debt_fraction" data-pysam-module="Cashloan" step="0.1" min="0" max="100" value="60"><span class="input-group-text">%</span></div><div class="form-text text-muted small">% of capital financed via debt.</div></div></div><div class="col-md-6"><div class="mb-3"><label for="loan_rate" class="form-label">Loan Interest Rate (%)</label><div class="input-group"><input type="number" class="form-control" id="loan_rate" data-pysam-key="loan_rate" data-pysam-module="Cashloan" step="0.1" min="0" max="100" value="10"><span class="input-group-text">%</span></div><div class="form-text text-muted small">Annual interest rate on debt.</div></div></div><div class="col-md-6"><div class="mb-3"><label for="loan_term" class="form-label">Loan Term (years)</label><input type="number" class="form-control" id="loan_term" data-pysam-key="loan_term" data-pysam-module="Cashloan" min="1" max="40" value="25"><div class="form-text text-muted small">Loan repayment period.</div></div></div><div class="col-md-6"><div class="mb-3"><label for="macrs_option_years" class="form-label">Depreciation Method</label><select class="form-control" id="macrs_option_years" data-pysam-key="macrs_option_years" data-pysam-module="Cashloan" value=""><option value="" selected="selected">-- Select --</option><option value="0=5">0=5</option><option value="1=7">1=7</option><option value="2=15 yrs">2=15 yrs</option></select></div></div><div class="col-md-6"><div class="mb-3"><label for="macrs_bonus_frac" class="form-label">Bonus Depreciation (%)</label><div class="input-group"><input type="number" class="form-control" id="macrs_bonus_frac" data-pysam-key="macrs_bonus_frac" data-pysam-module="Cashloan" step="0.1" min="0" max="100" value=""><span class="input-group-text">%</span></div><div class="form-text text-muted small">% of asset value depreciated Year 1.</div></div></div><div class="col-md-6"><div class="mb-3"><label for="voll" class="form-label">Value of Lost Load $/kWh</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="voll" data-pysam-key="voll" data-pysam-module="Pvsamv1" step="0.01" min="0" value="0.35"></div><div class="form-text text-muted small">value of lost load for resilience calcs</div></div></div><div class="col-md-6"><div class="mb-3"><label for="incentive_stc" class="form-label">STC Price Avg ($)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="incentive_stc" data-pysam-key="incentive_stc" data-pysam-module="Cashloan" step="0.01" min="0" value="40"></div><div class="form-text text-muted small">Small scale renewable certificates</div></div></div><div class="col-md-6"><div class="mb-3"><label for="incentive_lrec" class="form-label">LREC Price Avg ($)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="incentive_lrec" data-pysam-key="incentive_lrec" data-pysam-module="Cashloan" step="0.01" min="0" value="45"></div><div class="form-text text-muted small">Large scale renewable certificates</div></div></div><div class="col-md-6"><div class="mb-3"><label for="mp_energy_market_revenue" class="form-label">Energy arbitrage Y/N?</label><select class="form-control" id="mp_energy_market_revenue" data-pysam-key="mp_energy_market_revenue" data-pysam-module="Pvsamv1" value=""><option value="" selected="selected">-- Select --</option><option value="yes">yes</option><option value="no">no</option></select></div></div></div>
        <div class="fcas-section" id="fcas-config-container">
            <div class="subsection-header">
                <h4><i class="fas fa-bolt me-2"></i>FCAS (Frequency Control Ancillary Services)</h4>
            </div>

            <div class="fcas-auto-config mb-4">
                <div class="d-flex align-items-center justify-content-between">
                    <div>
                        <h5 class="mb-1"><i class="fas fa-magic me-2"></i>Enhanced FCAS Revenue Forecasting</h5>
                        <p class="text-muted mb-0 fs-6">ML-based forecasting for Australian NEM FCAS markets</p>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="fcas-enable" data-pysam-key="fcas_enabled">
                        <label class="form-check-label fw-semibold" for="fcas-enable">
                            Enable FCAS
                        </label>
                    </div>
                </div>
            </div>

            <div id="fcas-configuration" class="space-y-6" style="display: none;">
                <div class="fcas-auto-config">
                    <h5 class="mb-3"><i class="fas fa-cog me-2"></i>Auto-Configuration</h5>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label for="fcas-region" class="form-label fw-semibold">
                                NEM Region <i class="fas fa-info-circle text-muted" title="Auto-detected from project location"></i>
                            </label>
                            <select id="fcas-region" class="form-control" data-pysam-key="fcas_region" value="QLD1">
                                <option value="NSW1">NSW1 - New South Wales</option>
                                <option value="VIC1">VIC1 - Victoria</option>
                                <option value="QLD1" selected="selected">QLD1 - Queensland</option>
                                <option value="SA1">SA1 - South Australia</option>
                                <option value="TAS1">TAS1 - Tasmania</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="fcas-participation-rate" class="form-label fw-semibold">
                                Participation Rate (%) <i class="fas fa-info-circle text-muted" title="Auto-calculated from battery size"></i>
                            </label>
                            <input type="number" id="fcas-participation-rate" class="form-control" data-pysam-key="fcas_participation_rate" min="0" max="100" step="1" value="85" readonly="">
                        </div>
                        <div class="col-md-4">
                            <label for="fcas-battery-reserve" class="form-label fw-semibold">
                                Battery Reserve (%)
                            </label>
                            <input type="number" id="fcas-battery-reserve" class="form-control" data-pysam-key="fcas_battery_reserve" min="0" max="50" step="5" value="20">
                        </div>
                    </div>
                </div>

                <div class="rate-input-group">
                    <h5 class="mb-3"><i class="fas fa-list-check me-2"></i>FCAS Services Selection</h5>
                    <div class="fcas-service-grid" id="fcas-services-grid">
        <div class="fcas-service-card enabled" data-service="fcas_enable_fast_raise">
            <div class="d-flex align-items-start justify-content-between mb-2">
                <div class="d-flex align-items-center">
                    <i class="fas fa-arrow-up me-2 text-primary"></i>
                    <strong>Fast Raise (6s)</strong>
                </div>
                <div class="form-check form-switch">
                    <input class="form-check-input fcas-service-toggle" type="checkbox" id="fcas_enable_fast_raise" data-pysam-key="fcas_enable_fast_raise" checked="checked">
                </div>
            </div>
            <p class="text-muted small mb-2">Rapid frequency response for under-frequency events</p>
            <span class="badge bg-success">Recommended</span>
        </div>
    
        <div class="fcas-service-card enabled" data-service="fcas_enable_fast_lower">
            <div class="d-flex align-items-start justify-content-between mb-2">
                <div class="d-flex align-items-center">
                    <i class="fas fa-arrow-down me-2 text-primary"></i>
                    <strong>Fast Lower (6s)</strong>
                </div>
                <div class="form-check form-switch">
                    <input class="form-check-input fcas-service-toggle" type="checkbox" id="fcas_enable_fast_lower" data-pysam-key="fcas_enable_fast_lower" checked="checked">
                </div>
            </div>
            <p class="text-muted small mb-2">Rapid frequency response for over-frequency events</p>
            <span class="badge bg-success">Recommended</span>
        </div>
    
        <div class="fcas-service-card enabled" data-service="fcas_enable_slow_raise">
            <div class="d-flex align-items-start justify-content-between mb-2">
                <div class="d-flex align-items-center">
                    <i class="fas fa-chevron-up me-2 text-primary"></i>
                    <strong>Slow Raise (60s)</strong>
                </div>
                <div class="form-check form-switch">
                    <input class="form-check-input fcas-service-toggle" type="checkbox" id="fcas_enable_slow_raise" data-pysam-key="fcas_enable_slow_raise" checked="checked">
                </div>
            </div>
            <p class="text-muted small mb-2">Sustained frequency response for under-frequency events</p>
            <span class="badge bg-success">Recommended</span>
        </div>
    
        <div class="fcas-service-card enabled" data-service="fcas_enable_slow_lower">
            <div class="d-flex align-items-start justify-content-between mb-2">
                <div class="d-flex align-items-center">
                    <i class="fas fa-chevron-down me-2 text-primary"></i>
                    <strong>Slow Lower (60s)</strong>
                </div>
                <div class="form-check form-switch">
                    <input class="form-check-input fcas-service-toggle" type="checkbox" id="fcas_enable_slow_lower" data-pysam-key="fcas_enable_slow_lower" checked="checked">
                </div>
            </div>
            <p class="text-muted small mb-2">Sustained frequency response for over-frequency events</p>
            <span class="badge bg-success">Recommended</span>
        </div>
    
        <div class="fcas-service-card " data-service="fcas_enable_delayed_raise">
            <div class="d-flex align-items-start justify-content-between mb-2">
                <div class="d-flex align-items-center">
                    <i class="fas fa-clock me-2 text-primary"></i>
                    <strong>Delayed Raise (5min)</strong>
                </div>
                <div class="form-check form-switch">
                    <input class="form-check-input fcas-service-toggle" type="checkbox" id="fcas_enable_delayed_raise" data-pysam-key="fcas_enable_delayed_raise">
                </div>
            </div>
            <p class="text-muted small mb-2">Extended frequency response for under-frequency events</p>
            <span class="badge bg-secondary">Optional</span>
        </div>
    
        <div class="fcas-service-card " data-service="fcas_enable_delayed_lower">
            <div class="d-flex align-items-start justify-content-between mb-2">
                <div class="d-flex align-items-center">
                    <i class="fas fa-clock me-2 text-primary"></i>
                    <strong>Delayed Lower (5min)</strong>
                </div>
                <div class="form-check form-switch">
                    <input class="form-check-input fcas-service-toggle" type="checkbox" id="fcas_enable_delayed_lower" data-pysam-key="fcas_enable_delayed_lower">
                </div>
            </div>
            <p class="text-muted small mb-2">Extended frequency response for over-frequency events</p>
            <span class="badge bg-secondary">Optional</span>
        </div>
    
        <div class="fcas-service-card " data-service="fcas_enable_raise_regulation">
            <div class="d-flex align-items-start justify-content-between mb-2">
                <div class="d-flex align-items-center">
                    <i class="fas fa-wave-square me-2 text-primary"></i>
                    <strong>Raise Regulation</strong>
                </div>
                <div class="form-check form-switch">
                    <input class="form-check-input fcas-service-toggle" type="checkbox" id="fcas_enable_raise_regulation" data-pysam-key="fcas_enable_raise_regulation">
                </div>
            </div>
            <p class="text-muted small mb-2">Continuous regulation for small frequency deviations</p>
            <span class="badge bg-secondary">Optional</span>
        </div>
    
        <div class="fcas-service-card " data-service="fcas_enable_lower_regulation">
            <div class="d-flex align-items-start justify-content-between mb-2">
                <div class="d-flex align-items-center">
                    <i class="fas fa-wave-square me-2 text-primary"></i>
                    <strong>Lower Regulation</strong>
                </div>
                <div class="form-check form-switch">
                    <input class="form-check-input fcas-service-toggle" type="checkbox" id="fcas_enable_lower_regulation" data-pysam-key="fcas_enable_lower_regulation">
                </div>
            </div>
            <p class="text-muted small mb-2">Continuous regulation for small frequency deviations</p>
            <span class="badge bg-secondary">Optional</span>
        </div>
    </div>
                </div>

                <div class="fcas-revenue-estimate" id="fcas-revenue-display">
                    <h5 class="mb-2"><i class="fas fa-chart-line me-2"></i>Estimated Annual FCAS Revenue</h5>
                    <div class="fs-2 fw-bold text-success" id="fcas-revenue-amount">0</div>
                    <small class="text-muted">Based on current configuration and historical market data</small>
                </div>

                <div class="collapse" id="fcas-advanced-config">
                    <div class="rate-input-group">
                        <h5 class="mb-3"><i class="fas fa-cogs me-2"></i>Advanced Configuration</h5>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="fcas-forecast-method" class="form-label fw-semibold">Forecast Method</label>
                                <select id="fcas-forecast-method" class="form-control" data-pysam-key="fcas_forecast_method" value="ML">
                                    <option value="ML" selected="selected">Machine Learning (Recommended)</option>
                                    <option value="historical">Historical Average</option>
                                    <option value="conservative">Conservative Estimate</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="fcas-database-path" class="form-label fw-semibold">Database Path</label>
                                <input type="text" id="fcas-database-path" class="form-control" data-pysam-key="fcas_db_path" value="FCAS/nem_data_final.db" readonly="">
                            </div>
                        </div>
                        <div class="row g-3 mt-2">
                            <div class="col-md-6">
                                <label for="fcas-fast-premium" class="form-label fw-semibold">Fast Services Premium ($/MW/5min)</label>
                                <input type="number" id="fcas-fast-premium" class="form-control" data-pysam-key="fcas_fast_premium" min="0" step="0.01" value="0">
                            </div>
                            <div class="col-md-6">
                                <label for="fcas-regulation-premium" class="form-label fw-semibold">Regulation Premium ($/MW/5min)</label>
                                <input type="number" id="fcas-regulation-premium" class="form-control" data-pysam-key="fcas_regulation_premium" min="0" step="0.01" value="0">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="text-center">
                    <button type="button" class="btn btn-outline-secondary btn-sm" data-bs-toggle="collapse" data-bs-target="#fcas-advanced-config">
                        <i class="fas fa-chevron-down me-2"></i>Advanced Configuration
                    </button>
                </div>
            </div>
        <input type="hidden" id="hidden_fcas_enabled" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_enabled" value="No"><input type="hidden" id="hidden_fcas_region" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_region" value="DISABLED"><input type="hidden" id="hidden_fcas_participation_rate" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_participation_rate" value="0"><input type="hidden" id="hidden_fcas_db_path" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_db_path" value=""><input type="hidden" id="hidden_fcas_battery_reserve" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_battery_reserve" value="0"><input type="hidden" id="hidden_fcas_enable_fast_raise" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_enable_fast_raise" value="No"><input type="hidden" id="hidden_fcas_enable_fast_lower" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_enable_fast_lower" value="No"><input type="hidden" id="hidden_fcas_enable_slow_raise" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_enable_slow_raise" value="No"><input type="hidden" id="hidden_fcas_enable_slow_lower" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_enable_slow_lower" value="No"><input type="hidden" id="hidden_fcas_enable_delayed_raise" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_enable_delayed_raise" value="No"><input type="hidden" id="hidden_fcas_enable_delayed_lower" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_enable_delayed_lower" value="No"><input type="hidden" id="hidden_fcas_enable_raise_regulation" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_enable_raise_regulation" value="No"><input type="hidden" id="hidden_fcas_enable_lower_regulation" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_enable_lower_regulation" value="No"><input type="hidden" id="hidden_fcas_forecast_method" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_forecast_method" value="disabled"><input type="hidden" id="hidden_fcas_fast_premium" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_fast_premium" value="0"><input type="hidden" id="hidden_fcas_regulation_premium" data-pysam-module="Enhanced_FCAS" data-pysam-key="fcas_regulation_premium" value="0"></div>
    </div></div><div class="tab-pane fade" id="project-costs"><div class="form-card p-4"><h3 class="mb-4"><i class="fas fa-calculator me-2 text-primary"></i>Project Costs</h3><div class="subsection-header"><h4><i class="fas fa-layer-group me-2"></i>PV ($)</h4></div><div class="row"><div class="col-md-6"><div class="mb-3"><label for="total_installed_cost" class="form-label">Cost per kW ($/kW DC)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="total_installed_cost" data-pysam-key="total_installed_cost" data-pysam-module="Pvsamv1" step="0.01" min="0" value="1000"></div><div class="form-text text-muted small">Total installed cost</div></div></div><div class="col-md-6"><div class="mb-3"><label for="om_capacity" class="form-label">OM Costs per kW ($/kW/year)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="om_capacity" data-pysam-key="om_capacity" data-pysam-module="Pvsamv1" step="0.01" min="0" value="21"></div><div class="form-text text-muted small">Fixed O&amp;M Cost</div></div></div><div class="col-md-6"><div class="mb-3"><label for="om_production" class="form-label">OM Costs per kWh ($/kWh)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="om_production" data-pysam-key="om_production" data-pysam-module="Pvsamv1" step="0.01" min="0" value="1.5"></div><div class="form-text text-muted small">Variable O&amp;M Cost</div></div></div><div class="col-md-6"><div class="mb-3"><label for="bos_pv_cost" class="form-label">Balance of system equipment</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="bos_pv_cost" data-pysam-key="bos_pv_cost" data-pysam-module="Pvsamv1" step="0.01" min="0" value="555"></div><div class="form-text text-muted small">Balance of system (PV) costs</div></div></div><div class="col-md-6"><div class="mb-3"><label for="inverter_cost" class="form-label">Inverter Cost ($/W)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="inverter_cost" data-pysam-key="inverter_cost" data-pysam-module="Pvsamv1" step="0.01" min="0" value="444"></div><div class="form-text text-muted small">Inverter cost installed</div></div></div></div><div class="subsection-header"><h4><i class="fas fa-layer-group me-2"></i>Battery ($)</h4></div><div class="row"><div class="col-md-6"><div class="mb-3"><label for="battery_per_kWh" class="form-label">Installed Cost ($/kWh)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="battery_per_kWh" data-pysam-key="battery_per_kWh" data-pysam-module="Cashloan" step="0.01" min="0" value="470"></div><div class="form-text text-muted small">cost per kwh of storage capacity</div></div></div><div class="col-md-6"><div class="mb-3"><label for="om_batt_variable_cost" class="form-label">OM Costs per MWh ($MWh)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="om_batt_variable_cost" data-pysam-key="om_batt_variable_cost" data-pysam-module="Pvsamv1" step="0.01" min="0" value="20"></div><div class="form-text text-muted small">Operational cost by volume</div></div></div><div class="col-md-6"><div class="mb-3"><label for="om_batt_fixed_cost" class="form-label">OM Costs fixed ($/kW-year)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="om_batt_fixed_cost" data-pysam-key="om_batt_fixed_cost" data-pysam-module="Pvsamv1" step="0.01" min="0" value="10"></div><div class="form-text text-muted small">Operational cost by capacity</div></div></div><div class="col-md-6"><div class="mb-3"><label for="bos_battery_costs" class="form-label">Balance of system equipment</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="bos_battery_costs" data-pysam-key="bos_battery_costs" data-pysam-module="Pvsamv1" step="0.01" min="0" value="666"></div><div class="form-text text-muted small">Balance of system (Batt) costs</div></div></div><div class="col-md-6"><div class="mb-3"><label for="om_batt_replacement_cost" class="form-label">Battery Replacement Cost ($/kWh)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="om_batt_replacement_cost" data-pysam-key="om_batt_replacement_cost" data-pysam-module="Pvsamv1" step="0.01" min="0" value="1800"></div><div class="form-text text-muted small">Cost per kWh for replacing battery</div></div></div><div class="col-md-6"><div class="mb-3"><label for="om_fixed" class="form-label">O&amp;M Cost Fixed ($year)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="om_fixed" data-pysam-key="om_fixed" data-pysam-module="Cashloan" step="0.01" min="0" value="50"></div><div class="form-text text-muted small">O&amp;M Costs Fixed</div></div></div></div><div class="subsection-header"><h4><i class="fas fa-layer-group me-2"></i>Project ($)</h4></div><div class="row"><div class="col-md-6"><div class="mb-3"><label for="insurance_rate" class="form-label">Insurance Rate (%)</label><div class="input-group"><input type="number" class="form-control" id="insurance_rate" data-pysam-key="insurance_rate" data-pysam-module="Cashloan" step="0.1" min="0" max="100" value="1"><span class="input-group-text">%</span></div><div class="form-text text-muted small">Insurance rate applied on total cost</div></div></div><div class="col-md-6"><div class="mb-3"><label for="om_land_lease" class="form-label">Land lease cost [$/acre]</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="om_land_lease" data-pysam-key="om_land_lease" data-pysam-module="Pvsamv1" step="0.01" min="0" value=""></div><div class="form-text text-muted small">Land leasing costs per year</div></div></div><div class="col-md-6"><div class="mb-3"><label for="permitting_costs" class="form-label">Permitting and environmental studies $</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="permitting_costs" data-pysam-key="permitting_costs" data-pysam-module="Pvsamv1" step="0.01" min="0" value="10000"></div><div class="form-text text-muted small">Project cost grouping - Permitting</div></div></div><div class="col-md-6"><div class="mb-3"><label for="engineering_costs" class="form-label">Engineering and developer overhead $</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="engineering_costs" data-pysam-key="engineering_costs" data-pysam-module="Pvsamv1" step="0.01" min="0" value="200000"></div><div class="form-text text-muted small">Project cost grouping - Engineering</div></div></div><div class="col-md-6"><div class="mb-3"><label for="grid_interconnection_costs" class="form-label">Grid interconnection ($)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="grid_interconnection_costs" data-pysam-key="grid_interconnection_costs" data-pysam-module="Pvsamv1" step="0.01" min="0" value="1002"></div><div class="form-text text-muted small">Project cost grouping - Grid Connection</div></div></div><div class="col-md-6"><div class="mb-3"><label for="metering_costs" class="form-label">Metering and CTs installation ($)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="metering_costs" data-pysam-key="metering_costs" data-pysam-module="Pvsamv1" step="0.01" min="0" value="1003"></div><div class="form-text text-muted small">Project cost groupings - Metering</div></div></div><div class="col-md-6"><div class="mb-3"><label for="overhead_costs" class="form-label">Overhead Costs ($)</label><div class="input-group"><span class="input-group-text">$</span><input type="number" class="form-control" id="overhead_costs" data-pysam-key="overhead_costs" data-pysam-module="Pvsamv1" step="0.01" min="0" value="1005"></div><div class="form-text text-muted small">Fixed costs for admin &amp; oversight</div></div></div><div class="col-md-6"><div class="mb-3"><label for="installer_margin" class="form-label">Installer margin (%)</label><div class="input-group"><input type="number" class="form-control" id="installer_margin" data-pysam-key="installer_margin" data-pysam-module="Pvsamv1" step="0.1" min="0" max="100" value="5"><span class="input-group-text">%</span></div><div class="form-text text-muted small">Margin applied to overall project</div></div></div></div></div></div><div class="tab-pane fade show active" id="load"><div class="form-card p-4"><h3 class="mb-4"><i class="fas fa-chart-line me-2 text-primary"></i>Load</h3>
        <!-- Grid Connection Configuration Section -->
        <div class="subsection-header">
            <h4><i class="fas fa-plug me-2"></i>Grid Connection Configuration</h4>
        </div>
        <div class="rate-input-group mb-4">
            <div class="row g-3">
                <div class="col-md-6">
                    <label for="enable_interconnection_limit" class="form-label fw-semibold">
                        Enable Grid Interconnection Limit?
                    </label>
                    <select class="form-control" id="enable_interconnection_limit" name="enable_interconnection_limit" data-pysam-key="grid.enable_interconnection_limit" value="yes">
                        <option value="yes" selected="selected">Yes</option>
                        <option value="no">No</option>
                    </select>
                    <div class="form-text">Controls whether to enforce AC power limits to/from grid</div>
                </div>
                <div class="col-md-6">
                    <label for="grid_interconnection_limit_kwac" class="form-label fw-semibold">
                        Grid Interconnection Limit (kW AC)
                    </label>
                    <input type="number" class="form-control" id="grid_interconnection_limit_kwac" name="grid_interconnection_limit_kwac" data-pysam-key="grid.grid_interconnection_limit_kwac" value="" min="0" step="0.1" placeholder="Optional">
                    <div class="form-text">Maximum AC power allowed to/from grid</div>
                </div>
            </div>
            <div class="row g-3 mt-2">
                <div class="col-md-4">
                    <label for="load_escalation" class="form-label fw-semibold">
                        Load Escalation (%)
                        <span class="text-danger">*</span>
                    </label>
                    <input type="number" class="form-control" id="load_escalation" name="load_escalation" data-pysam-key="grid.load_escalation" value="2" min="-10" max="20" step="0.1" required="">
                    <div class="form-text">Annual load growth rate (%/year)</div>
                </div>
                <div class="col-md-4">
                    <label for="load_step" class="form-label fw-semibold">
                        Data Resolution
                        <span class="text-danger">*</span>
                    </label>
                    <select class="form-control" id="load_step" name="load_step" data-pysam-key="grid.load_step" required="" value="1">
                        <option value="1" selected="selected">Hourly (8760 points)</option>
                        <option value="24">Daily (365 points)</option>
                    </select>
                    <div class="form-text">Time resolution for load data analysis</div>
                </div>
                <div class="col-md-4">
                    <label for="load_peak" class="form-label fw-semibold">
                        Peak Demand (kW)
                    </label>
                    <input type="number" class="form-control" id="load_peak" name="load_peak" data-pysam-key="grid.load_peak" value="" min="0" step="0.1" placeholder="Auto-calculated from profile">
                    <div class="form-text">Maximum load in profile (auto-calculated if empty)</div>
                </div>
            </div>
        </div>

        <!-- Annual Energy Fallback -->
        <div class="subsection-header">
            <h4><i class="fas fa-battery-three-quarters me-2"></i>Load Data Configuration</h4>
        </div>
        <div class="rate-input-group mb-4">
            <div class="row g-3">
                <div class="col-md-6">
                    <label for="annual_energy" class="form-label fw-semibold">
                        Annual AC Energy in Year 1 (kWh)
                    </label>
                    <input type="number" class="form-control" id="annual_energy" name="annual_energy" data-pysam-key="grid.annual_energy" value="726208" min="0" step="1">
                    <div class="form-text">Used only if no detailed load profile is provided</div>
                </div>
                <div class="col-md-6">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Load Data Priority:</strong><br>
                        1. Custom CSV upload (preferred)<br>
                        2. Auto-generated profile<br>
                        3. Annual energy fallback
                    </div>
                </div>
            </div>
        </div>

        <div class="load-section" id="load-config-container">
            <div class="subsection-header">
                <h4><i class="fas fa-chart-line me-2"></i>Load Profile Configuration</h4>
            </div>

            <!-- Load Method Selection -->
            <div class="mb-4">
                <h5 class="mb-3"><i class="fas fa-cog me-2"></i>Load Data Method</h5>
                <div class="row g-3">
                    <div class="col-md-4">
                        <div class="load-method-card" data-method="auto" onclick="selectLoadMethod('auto')">
                            <div class="text-center">
                                <div class="method-icon text-primary">
                                    <i class="fas fa-magic"></i>
                                </div>
                                <h6 class="fw-semibold">Auto-Generate</h6>
                                <p class="text-muted small mb-0">Generate typical load profile from annual energy</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="load-method-card" data-method="manual" onclick="selectLoadMethod('manual')">
                            <div class="text-center">
                                <div class="method-icon text-warning">
                                    <i class="fas fa-edit"></i>
                                </div>
                                <h6 class="fw-semibold">Manual Entry</h6>
                                <p class="text-muted small mb-0">Enter monthly energy consumption</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="load-method-card selected" data-method="file" onclick="selectLoadMethod('file')">
                            <div class="text-center">
                                <div class="method-icon text-success">
                                    <i class="fas fa-upload"></i>
                                </div>
                                <h6 class="fw-semibold">Upload CSV</h6>
                                <p class="text-muted small mb-0">Upload 8760-hour load data</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Load Configuration Content -->
            <div id="load-config-content">
        <div class="rate-input-group">
            <h5 class="mb-3"><i class="fas fa-upload me-2"></i>Upload Load Data File</h5>
            <div class="upload-area" id="upload-area" ondrop="handleFileDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                <div class="text-center">
                    <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                    <h6>Drop CSV file here or click to browse</h6>
                    <p class="text-muted mb-3">File must contain 8760 hourly load values (kWh)</p>
                    <input type="file" id="load-file-input" accept=".csv" style="display: none;" onchange="handleFileSelect(event)" value="C:\fakepath\House28760.csv">
                    <button type="button" class="btn btn-outline-primary" onclick="document.getElementById('load-file-input').click()">
                        <i class="fas fa-folder-open me-2"></i>Browse Files
                    </button>
                </div>
            </div>

            <div id="upload-progress-container" style="display: none;">
                <div class="upload-progress">
                    <div class="upload-progress-bar" id="upload-progress-bar" style="width: 0%;"></div>
                </div>
                <div class="text-center">
                    <small class="text-muted" id="upload-status">Uploading...</small>
                </div>
            </div>

            <div class="mt-3">
                <h6>File Format Requirements:</h6>
                <ul class="small text-muted">
                    <li>CSV format with single column of hourly load values</li>
                    <li>Exactly 8760 rows (365 days √ó 24 hours)</li>
                    <li>Values in kWh (positive numbers)</li>
                    <li>Optional header row will be detected automatically</li>
                </ul>
            </div>
        </div>
    </div>

            <!-- Load Validation Results -->
            <div id="load-validation-display" style="display: block;">
        <div class="load-validation-result success">
            <div class="d-flex align-items-center">
                <i class="fas fa-check-circle me-2"></i>
                <div class="flex-grow-1">
                    <strong>Validation Passed</strong>
                    <div class="mt-1">Load data validated successfully. Total: 535241 kWh/year, Peak: 547.00 kWh</div>
                </div>
            </div>
        </div>
    </div>

            <!-- Load Chart Display -->
            <div id="load-chart-display" style="display: block;">
                <h5 class="mb-3"><i class="fas fa-chart-area me-2"></i>Load Profile Preview</h5>
                <div class="load-chart-container" id="load-chart-container"><canvas id="load-chart-canvas" style="display: block; box-sizing: border-box; height: 266px; width: 1164px;" width="1164" height="266"></canvas></div>
            </div>

            <!-- Hidden fields for PySAM integration -->
            <input type="hidden" id="hidden_load_method" data-pysam-key="load_method" value="file">
            <input type="hidden" id="hidden_load_data" data-pysam-key="load_data" value="[61.9,69.8,105.2,111.2,57.9,57.6,57.1,57.5,40.2,12.9,13.5,14.6,14.3,13.5,16.2,37.7,33.7,13.7,12.1,97.8,10.5,61.3,188.5,186,93.2,111,210.7,218.3,65.1,33.7,179.8,10,16.6,9.5,9.9,10.7,10.6,10.7,10.7,8.7,9.5,10.1,104.8,10.1,9.5,27.8,52.2,51.5,51.1,50.9,51,51.8,53.1,53,52.2,51.7,35.2,8.5,8.6,87.3,21.6,8.5,8.6,8.5,8.6,8.4,8.5,9.6,8.6,8.5,8.4,8.5,8.4,7.8,6.8,7.4,7.3,100.6,7.2,6.8,6.5,6.6,6.5,7.4,8.1,8,8,8.9,10,10,9.7,9.6,9,105.2,63.9,50,52.4,53.2,52.7,52.5,52.8,51.3,51.6,52.9,35,8.2,8.5,8.4,8.6,8.2,107.4,7.6,7.9,8.6,8.7,8.7,7.8,7.7,7.7,15.1,15.9,11.5,8.5,8.3,8.4,7.5,6.4,6.4,6.4,88.2,6.7,7.7,7.9,7.7,7.9,7.9,8.2,7.8,7.6,7.6,7.1,25.9,50.1,51.1,109,92,51.8,52.1,51.2,50.9,51.6,51.6,33,6,6.8,7.7,8,8.3,8.2,8.2,8.2,8.2,8.3,91.7,7.9,7.9,7.9,7.9,8.1,7.9,6.9,7.1,7.1,6.6,6.5,6.6,115.7,14,7.3,8.4,7.9,7.2,7.4,8.3,8.8,8.6,8.9,8.8,7.2,25.4,139.7,51.8,52.7,50.8,51.8,51.8,51.5,51.5,52.2,52.4,32.2,5.8,6.6,7.6,14.2,99.6,15.3,10.5,8.7,8.2,8.2,8,8.1,8.2,8.3,8.2,8.2,8.3,8.5,8.6,7.6,6.6,6.6,89.8,6.6,7.6,7.3,8.2,8.3,8.1,7.7,7.8,7.8,8.5,9.8,9.5,8.2,26,143.8,50.8,51.1,52.3,52.6,52.5,52.9,51.9,51.5,50.7,33.9,6.5,7.8,8.7,112.4,8.4,7.8,7.8,7.7,8.2,8.7,8.5,8.7,8.2,7.9,7.8,8.3,9.2,8.9,7.8,6.2,90,7.9,7.8,6.3,6.6,8.6,7.9,7.3,9,9.2,7.7,7.5,9,10,9.5,101.7,32.4,59.4,56,52.6,51.6,51.6,51.5,51.6,52.1,52.6,52.1,34.3,7.8,67.9,37.6,8.5,8.4,8.4,8.4,8.3,8.4,8.3,8.1,8.1,8.2,8,8.1,7.4,16.6,95.4,8.7,7.8,7.1,7.4,6.7,6.5,6.4,6.3,8.4,8.3,8.4,7.7,7.5,7.6,99.7,8.5,8.6,8.1,26,51.2,51.1,51.8,52,51.6,51.5,50.7,50.1,71.2,127.4,34.8,8.8,7.8,7.8,7.6,8.4,8.9,9.2,8,7.7,8.6,121.9,8.7,9.5,12.7,10.5,9.3,106.5,11.9,16.2,14.8,14.9,11.8,101.7,18.7,6.7,9.7,7.9,7.7,8.8,9.5,8.2,8,9.4,9.7,8.8,8.6,27.3,53.2,115.1,70.4,52.4,54.9,52.3,50.2,51.5,52.4,52.2,33.7,6.4,7,8.3,9.4,8,65,44.8,9.4,9.7,7.7,7,7.9,8.5,8.1,58.7,74.4,16.7,8,54.6,94.7,8.6,6.8,16.4,48.6,78.8,6.5,7.7,7.9,7.7,7.7,8.7,9.9,9.6,9.8,9.6,9.3,115.9,53.5,52.3,51.5,52.8,52,51.4,52.6,52.9,52.7,52.3,34.7,7.9,92.6,8.2,8.2,8,8.2,8.2,7.5,7.8,8.2,8.3,8.2,61.9,53.3,7.2,6.1,6.9,8.5,8.4,7.8,6.9,7.7,7.9,7.2,6.1,92.9,15,8.2,8.1,7.5,7.3,7.4,7.2,8.2,8.2,7.8,26.6,52.1,79.9,118.7,52,52.5,52.5,53,52.9,52.5,51.6,34,7.6,8.5,8.4,8.8,89,21.5,7.5,8.5,9.2,8.5,7.6,7.7,9.2,9.4,7.5,17.4,98.4,9,7.3,7.3,8.1,7.4,7.2,7.5,8,6.5,7.4,7.5,8.3,8.7,97.3,7.9,7.8,7.7,8.8,8.2,27.1,51.7,50.8,51.2,50.8,51.8,51.5,50.9,140.7,55.9,51.1,33.8,7.7,6.9,7.8,7.9,8.3,9.1,9.5,7.8,14.2,7.7,55.1,50.8,7.8,122.3,31.6,7.9,7.8,10.5,8.4,7.2,9.4,6.1,7.8,7.7,6,19.5,90.1,7,9.2,8.4,7.1,10.2,10.6,8.2,10.1,10.1,26.8,51.8,52.7,145.3,50.5,53.1,51,51.4,53.3,50.9,50.7,35.5,7.9,7.8,9.6,8.7,103.4,11.6,8.8,8.9,8.3,26.8,17.3,9.2,8.6,7.5,7.2,71.3,34.6,6.3,6.3,6.5,6.7,6.8,6.9,6.8,7.7,6.7,7.9,105.4,8.3,7.4,8.2,9.9,10,9.9,9.1,7.7,26.1,50.7,50.3,138.3,51.1,52.3,51.3,50.5,50.5,50.3,50.4,33.3,5.9,5.9,85.2,25.2,8.3,8.4,8.2,7.8,7.6,7.6,7.6,8.4,8.7,8.7,79.2,23.9,7.7,11.7,8.8,8.7,119.7,6.3,7.5,7.3,5.8,5.8,9.4,9.6,7,7.1,12.3,99,7.5,7,8.9,8.4,38.1,55.3,53.5,52.9,51.7,50.4,145,50.5,50.1,50.7,50.8,32.8,5.9,6.7,7.7,7.8,7.6,7.9,98.6,8,7.9,8,8.1,8.1,8,8.1,8.1,7.4,7.1,8,92.6,7.9,8,7.1,6.2,6.2,6.6,6.7,7.7,7.8,7.8,78.5,27.9,7.5,7.5,7.5,7.6,7.7,26.1,50.6,50.3,50.9,85.6,114.8,50.1,49.8,49.9,50.4,50.2,32.7,7.1,8.3,7.9,7.6,94.2,7.5,7.8,11,8.4,8.3,8.5,7.7,7.5,7.7,8.6,8.8,90.3,7,5.9,7.5,8,6,8.6,6.9,16.8,10.9,9.9,8.7,102.1,7.6,7.7,8.1,8.5,8.5,8.4,7.9,26.4,50.2,50.1,80.1,114.1,51.7,50.9,51,52.1,51.3,51.1,34.2,8.4,8.3,8.2,92.7,8,8.1,7.9,8,8.1,8.6,8.6,35,208.1,209.2,43.6,14.2,12.8,10.9,20,48.4,28.1,24,105.7,41.9,63.6,23.1,26.5,49.3,55,189.1,35.3,48.3,30.1,21.5,51.9,18.3,37.3,118.7,94,60.3,58.9,57.5,61.5,60.5,58.1,56.9,57.9,41.4,99.4,22.4,13.2,32.6,27.8,18.1,21.2,19.6,25.5,35.5,20.6,138.5,27.8,27.6,27,20,51.2,117.1,19.3,21.9,25.5,103.8,449.9,280.2,247.1,305.8,181.3,31.4,321.3,47.8,49.8,180.1,27.8,23.1,22.6,42.2,46.9,161.5,89.1,229.4,67.8,67.1,66.8,68.2,64.5,66.3,67.5,47.4,19.4,71.9,62.8,27.9,29.4,32.5,28.9,22.2,165.2,14.6,15.9,17.3,22.4,162.1,60.7,12.7,13.1,13,23.7,23.6,76.7,53.2,137.7,61.9,59.8,119.3,28.3,53.1,203.4,42.4,33.4,32.5,25.3,19,10.3,8.3,30.2,148.1,55.4,53.4,54.6,53.4,54.4,54.7,55.4,55.4,53.5,124.8,10.8,24.6,34.7,12.3,117.5,9.5,10.9,11,9.4,9.2,31.1,32.5,122.4,21.8,24.7,27.5,25.1,22.4,25.1,31.5,84.8,70.8,13.7,73.6,141,96.7,33.5,26.8,65.6,93.9,90.5,39.2,19.5,133.4,9.1,8.3,30.2,52.4,53.7,55.5,53.7,54.4,53,119.3,77.7,53.2,51.8,48.2,142.5,28,19.4,51.1,125.8,135.1,24.9,27.7,30.4,23.9,23.5,21.7,19.2,118.6,19.4,19.7,17.9,16.9,17.9,152,18.1,25.5,24.2,26.3,26.9,23.5,17.5,166.6,15.8,17.2,54.8,31.2,24.8,20.8,98.1,16.7,30,50,53.5,50.5,51.5,51.7,50.4,87.2,109.1,51.7,51.3,32.1,57.1,117.3,53.4,35.1,74.6,86.2,16,15.5,21.2,137.5,17.3,14.6,11.4,15.9,28.9,19.8,23.5,23.1,22.4,110.2,34.9,30.3,24.3,19.8,46.5,31,276.7,152.6,74.5,35.1,41.6,25.9,170.3,49.8,57.4,78.6,99.8,67.3,52,54.6,51.6,150.8,52.1,52.5,56,53.1,55.4,35.9,21.6,151.2,14.2,112.1,96.2,30.1,19.8,16.6,20.9,15.4,12.7,20.3,95.4,35.8,24.4,18.6,16.7,21,16.3,17.2,127.8,45.2,14.6,27.8,25.7,27,83.8,95.6,82.3,41.4,44.5,42.4,64.6,119.6,12.1,12.8,30.8,53.9,54.8,52.2,51.8,109.8,91.7,54.7,53.1,52.7,53.8,35.5,76.4,233.2,86.4,25,48,30.5,12.7,88.5,52.5,20.4,162,17.9,14.1,15.4,20.8,18.3,19.1,15.8,26.8,70.9,61.7,23.7,24.9,27.3,15.9,125.7,11.5,11,12.1,26.2,29.9,53.7,180.7,37,32.4,26.8,33.8,58.2,55.7,55.2,57.1,155.5,55.3,54.8,56.4,58,57,38.1,23.4,144.5,98.7,16,17.6,23.3,16,131.7,24.5,30.2,30.1,26.9,26.5,27.1,24.6,29.9,70.6,77.8,27.4,19.4,13.3,11.2,11.4,20.1,258.5,27.5,23.8,23.8,23.8,32.5,226.7,147.3,39.1,29.5,30.5,21,33.3,165,56.3,57.5,57.7,56.2,56.3,56.7,56.4,93.2,117.6,38.1,12.9,10.3,13.3,20.3,69,49,173.1,17.9,28.8,20.4,14.2,19.7,28.9,123.5,26.2,56.1,193.3,81.2,14.9,13.5,20.5,134.1,16.8,24.8,80.3,102.6,53,57.4,101.2,93,24.6,23.2,29.9,24.3,25.3,9.8,28.8,146.8,54.8,52.4,53.9,50.8,53.1,51.3,55.5,99.3,98.2,35.6,8.7,8.8,7.5,24.6,15.2,104.9,43.4,18.3,42.7,31.5,23.3,16.7,15.5,107.5,31.8,175.1,231.3,146.5,62.9,27,163.1,52.2,24.1,18.5,17.3,35,26.9,127.3,22,13.1,24.3,37.3,27.8,30.3,20,110.6,29.9,54.6,54.8,55.2,52.7,52.8,53.2,148.1,54.1,52.9,52.6,36.8,10.5,8.9,7.5,123.2,27.7,115.6,136.6,29.3,31.9,40.1,152.2,18.1,35.7,33.4,22,25.2,17.7,165.1,59,7.2,0,0,0,0,174.1,205.2,73.9,44.3,24.1,130.4,55.8,25.4,70.7,17.7,17.3,15.9,41.3,157.9,52.4,50.5,51.2,52.7,52.1,50.7,51.1,153.4,52.7,34.8,21.4,174.3,110.5,32.4,104.8,136,180.5,75.8,20.1,26.6,36.8,25.9,113,112.1,34,49.5,227.5,173.8,28.1,44.9,208.4,33.7,25.8,58.8,157.7,92.3,213.2,87.7,64.2,183.8,191,24.5,24.3,30.4,21.7,11.8,33.8,168,56.7,54.5,54.8,52.7,57.2,53.6,72.8,133.7,54.4,37.4,19.3,176.7,54.8,17.8,62,23.9,143,25.9,15.1,15.4,13.1,223.4,51.5,15.7,10.6,12.2,9.5,11.2,64.4,60.5,13.1,20.4,29.9,23.2,177.1,132.5,64,44.7,229.7,43.4,32.3,114.7,79.3,64.4,137.8,19.5,36.3,61.3,59.9,57.8,60.5,57.4,156.3,56.8,56.4,58.1,55.1,40.2,106.6,50.8,69.1,45.4,131.9,13.1,12.9,23.8,17.8,20.2,17,113.1,23.6,18,14.1,18.2,18.1,18.2,12.9,120.4,28.1,21.1,25.9,20.4,62.3,148.9,27.6,42,27.6,33.7,142.8,57.3,30.4,64.6,27.4,99.3,62.6,68.3,57.3,57.7,57.6,56.5,147.1,54.9,55.3,56.8,55.7,37.1,24,208.6,87.9,38.9,30.3,125.7,23.7,22.5,17.7,18.1,19.3,41.6,106.4,24.5,15.9,15.2,18.4,18.9,117.8,13.5,13.6,24.3,72.7,66.9,144.7,36.9,34.9,108.6,245.5,143.4,82.6,39.1,30.2,98.9,60.3,10.6,30.4,53.4,53.6,54.9,165.3,53.3,53,53.2,53.8,53.9,110,87.9,7.9,7.9,8.1,8.2,62.6,197.2,68,216.6,29,24.2,14.5,12.5,34.6,222.7,37.5,46.4,52.3,160.6,91.8,71,176.6,225.6,265.3,164.3,43.9,119.8,133.6,74.1,52.5,53.1,161.5,77.3,47.3,116.9,275.9,141.5,58.9,68,177.3,64.8,55,55.8,56.5,53.9,54.4,139.6,71.4,46.6,11,11.8,9.4,9.7,119.9,11.9,26,53.9,273.9,94.5,226,115,31.3,18.2,139.1,24.9,26.9,26.4,32.1,28.4,129.9,27.6,20.7,35.3,192.2,179.6,65.6,30.7,83.8,165.3,49.6,29.1,219.6,31.8,11.8,10.8,30.9,55.7,141.1,71.4,56.4,56.1,56,54.7,118.3,100.1,55,37.7,21.3,153.4,41.4,70.7,165.7,22.5,13,10.4,10,17.5,120.6,22.7,16.1,14.6,13,24.8,123.2,14,10.8,11.4,8.3,19.3,135.3,32.4,33.8,189.8,257.3,103,30.2,56.7,82.6,147.3,49.5,32.1,18.1,10.9,91.2,106.9,56.4,55.4,56.6,56.7,110.7,111.6,54.9,55.8,54.9,35.1,101.4,179.3,22,116,128.4,36.1,11.8,141.4,10.1,19.6,24.6,24.1,108.3,32.1,16.3,23,14.8,85.5,54.9,10.8,17.1,13.9,7.4,96.5,103.3,29.9,49.5,188.8,43.5,50.8,207.5,33.1,31,24.7,12.4,9.9,140,58.2,56.4,56.7,56.6,56.2,167.1,55.3,56.2,56.5,54.8,37.6,131.8,19.9,138.8,127.4,23.9,12.8,12.5,59.5,89,16.3,14.7,14.9,21.1,42.9,103.4,15.6,15.1,14.4,158.1,16.2,15.3,11.6,11.9,94.2,93.7,137.9,170.5,81,36.7,38.4,30.1,181.1,105.7,28.7,23.2,23.2,36.9,164.6,66.6,59.8,58.3,58.1,57.4,164.2,57,57.1,57,38.4,71.6,78.8,191.9,137.2,81.8,85.9,17.5,130.8,21.7,13.4,17.3,19.2,40.1,115.7,16.7,16.6,13.8,13.6,28.5,114.9,23.8,18.9,14.2,94.4,120.5,49.2,87.6,74.8,152.6,30.8,55.3,54.6,161,16.9,17,8.9,27.8,62.5,160.5,62.3,57.4,56.5,54.1,106.4,113,54.1,54.4,37,20.8,231.9,95.2,51.1,133.9,57.6,28.7,24,121.4,37.3,10.6,10.2,20.5,13.1,129.1,13.8,18.1,16.9,22.3,14.5,123.9,17.3,19.9,23.8,20.3,109.5,176.8,96.9,137.9,94.5,170.2,144.2,30.1,30,22.9,21.3,142.9,66.7,59.3,59.1,59.4,59.6,171.2,67.3,59.5,59.6,57.5,85.9,78.8,9.8,10.9,49.3,131.2,148,20.3,15.2,57.6,182.7,64.9,63.5,67.2,198.3,79.2,234.1,190.3,87.6,63.1,62.1,61.8,136.7,81.9,24.9,78.6,196.7,183.4,40.7,248.7,99.3,32.3,27.7,25.2,45.3,123.7,31.1,46.9,58.6,58.5,172.1,56.8,55.5,55.6,53.8,136.6,85.4,53.8,37.2,7.8,59.6,76.3,11.1,9.7,16.2,18.1,137.6,10.8,20,26.2,20.2,245.5,158,237.8,31.3,27,30.1,172.8,23.1,25.7,176.7,72.5,83.4,57.2,184.6,51.7,67.4,262.2,87.4,48.2,149.9,63.5,24.9,26.1,16.6,47.9,151.1,56.6,56.2,54.6,53.9,169.8,54,53.2,53.4,52.9,89.8,78.6,30,243,44.7,19,13.7,28.7,137.9,20,16.5,15.8,128,19.2,12,24,15.7,114.1,41.7,14.5,14.6,21.9,74.9,70.2,19.2,74.5,163,45.1,35.6,230.9,66.4,43.5,176.8,38.4,26.2,16.6,11.1,143.7,64,56.3,55.7,56.1,123.1,105.9,54.4,53.8,55,94,115.6,23.5,176.7,180.6,44,28.7,13.1,134.9,11.3,23,17.2,56.6,136.7,39.2,150,232.6,115.6,23.7,200.4,70.1,126.2,15.7,12.4,28,137.6,52.6,176.4,194,55.1,41.7,55.9,111.9,106.3,151,63.4,69,92.3,71.5,56.2,55.2,53.7,137.3,92.7,56.4,53.4,54.1,137.2,92.6,37,16.1,114.3,235.2,222.7,26.2,18.9,22.7,16.3,15.1,11.4,17.7,15.2,117.3,19.7,14.1,14.5,14.7,12.4,11.2,26.2,14.9,24,19.2,17.4,20,58.2,116.6,19.7,15.2,13,16.2,41.4,59.9,34.1,20.8,17.5,34.1,56,54.9,55.3,59,153,58.2,58.4,56.6,56,56.4,38.2,10.5,42,19.1,24,17.3,17,15,135.4,80,25,15,15,12.2,12.7,13.6,23.5,15.9,16.4,13.6,11.5,17.5,15.9,10.1,7.8,10.1,10.2,254.3,105.8,26.9,109.3,125.5,23.7,50,29.5,17.9,15.1,33.1,56.2,57.1,53.1,53.5,55.8,53.8,54.2,56.2,55.2,54.8,38.6,12.4,19.4,158.7,47.4,21.1,15.5,19.7,13.4,28,41.8,53.6,16.1,18.2,135.5,31.9,19.4,15.9,17.5,18.3,20.3,18,19.5,33.2,28.1,56.1,46.9,119.9,47.9,40.9,32.5,36.7,44.5,32.8,58.8,26.4,13.9,31.5,56.4,53.9,53.8,54.5,54.8,54.3,54.2,71.9,137.6,55.6,36.9,9.5,9.4,15.4,14.3,20.5,33.8,26.1,16.9,22,102.1,64.1,22.6,31.5,45.6,31,32.6,21.2,19.2,18.1,14.6,15.1,43.2,103.5,18.3,22.4,17.9,171.4,199.4,216.5,41.8,48.2,40.7,27,23,26.8,118.3,37.4,56.8,56.4,53.6,52.4,53,53,53.1,54.1,53.7,53,34.5,8.4,9,7.8,8.4,20.4,37.6,39.7,17.5,23.9,123.3,27.2,26.4,147.4,10.4,12.1,11.2,15.5,24.9,36.3,26.7,19.9,15.5,16.2,142,181.5,226.9,178.1,35,75.8,74.3,44.7,108.8,53.8,45.8,88.2,82.7,102.8,78.9,58.9,57.7,55.8,55.2,54.2,54.3,54.1,54.4,54.6,37,25.9,206.2,25.9,78.5,110.5,51.7,13.8,14.9,24.4,186.7,16.3,14.2,12.8,13.1,13.7,11.4,10.1,10.9,9.4,7.7,7.9,26.5,19.6,12.6,18.6,141.1,160.8,52.6,49,106.9,198.7,34.1,47.3,26.5,33.8,13.2,32,56.2,56,55,54.9,54.7,54.5,54.3,54.1,53.7,55,35.8,19.4,107.7,81.9,39.1,24.1,18.3,160.1,13.4,14.2,22.4,13.4,13.1,13.7,15.9,17.5,24,17.6,17.2,22.3,107.4,14,24.1,13.3,13.5,28.9,62.6,44.4,42.9,77.1,104.2,153.2,30.3,30.3,25,19.7,8.9,81.3,104.8,55.6,55.2,55.4,55.7,55.7,55.5,56.6,56.3,56.6,37.9,39.5,156.5,35.5,24.2,22.2,35.5,137.2,11.8,10,11.7,14.6,16.4,15.1,10.1,12.2,8.8,10.8,8.9,11.3,16.7,24.9,26.4,33.8,138.6,158.6,53.9,35.2,49,97.1,124.9,23.6,22.1,54.2,27.7,29.4,23.8,41.9,55.6,55.4,55.7,54.9,55.1,55.3,54.8,55.1,55.3,55.8,35.9,18.1,188.6,88.9,55.2,14.6,13.5,37.9,33.4,14.1,11,118.2,27.6,13.1,18.6,16.2,14,13.6,21.1,14.4,11.7,31.2,153.7,25.2,17,14.7,89.9,81.3,42.1,67.8,160.7,60.5,46.9,27.6,92.5,60.8,12.5,32.6,57.3,56.3,55.6,55.2,55.1,54.6,55,56.3,56.1,56,37.4,23.9,16.4,156.4,99,22.7,11.6,13.1,13.4,11.6,11.8,9,8.3,11.2,8.7,10.6,10.6,8.1,11.2,8.2,12.4,20.6,12.3,24.3,28.9,120.1,13.9,21.1,42.5,43.4,40.3,47.9,36.4,27.8,137.7,18.3,83.4,70.1,129.4,59.2,56.6,56.4,54.5,54.4,56.2,53.5,53.6,55.9,36.7,6.5,17,14.2,16.4,14.8,145.6,56.3,26.7,27.1,202.6,69.9,21.6,26.4,21.9,23.1,31.6,27.5,35.3,28.3,129,17.1,102.4,90.8,106.3,91.8,70.9,54.8,133.1,46.3,46.5,36.5,30.3,132.2,123.8,42.3,33,36.8,60.8,57.4,57.6,56.2,55.6,150.6,54.7,57,54.6,56.7,38.3,8.9,10,11.4,18.7,59.8,55.3,26.3,16.4,20.1,26.9,125.2,84.5,20.5,22.9,29.7,45.6,27.4,113,60.7,33.9,18.8,21,17.6,45.2,86.1,122.1,337.4,234.5,84.2,45.7,76.4,159.8,146.3,32.4,32.9,28.9,38.8,64,58.6,59,57.3,56.6,54.5,54.2,55.7,57.9,54.4,35.1,22.1,183.2,22.1,34.4,14.9,15.7,26.5,128.5,47.4,21.9,15.3,19.3,16.8,20.6,18.2,16.6,23.4,19.3,15.4,17.3,15.3,19.9,17.3,21.6,30.6,91.6,31.1,39.7,187.7,34.2,127.2,90.8,29.7,35.5,28.3,15,42.5,60.8,60.9,60.4,59.2,59.9,60.2,58.7,57.6,57.4,57.4,218.1,127.8,101.2,26.7,13.5,52,25.8,18.2,137.8,14.4,12.5,13.2,63.3,54.6,41.4,181,51,24.2,80.5,176.8,24.6,15.8,11.4,11.2,24.2,67.4,106.7,143.1,164.3,128.7,52.9,43.1,163.2,31,32.1,22.8,11.9,31.5,56.5,63.8,56.3,55.9,56.5,54.5,54.4,54.4,54.2,54,122.8,33.6,221.9,119.1,145.3,14.4,12.4,12.2,12,12.1,12.2,12.5,12.4,12.7,11.8,11.8,12.6,12.3,10.1,11.4,13.1,29.6,27.3,33.7,33,145.2,27.7,37,45.4,48.4,39,106,102.5,88.3,81.5,93.5,21.3,32.7,57.8,56.3,56.6,54.6,55,57.9,57.9,55.9,55.7,55.4,37.3,41.8,230.1,28,13.8,15.2,12.7,13.8,14.7,12.4,14.6,13.5,13,13.6,11.4,15.8,12,15.3,11.3,12.5,12.1,25.3,129.5,24.7,23.9,23.2,91.3,205.1,114,44.1,37.5,226.1,244.9,112.5,33.9,20.5,14.6,32.5,54.1,55.8,55.8,55.3,54,53.5,55.7,55.6,118.5,92.7,36.2,25.4,162.7,175.7,17,17.7,17.7,12.9,9.9,10.6,10.5,10.3,10.3,10.2,8.7,9.4,8.6,8.2,8.1,8.1,18.7,121,25.4,33,16.2,22.2,17.3,15.8,28.7,17.2,12.7,13.8,13.8,27.8,25.8,20.2,15.3,78.8,61.8,59.1,56.3,56.8,54.7,53.2,53.2,53.9,149.9,55.3,36.9,9.5,8.5,8.6,8.5,21.7,36.5,126.7,149.8,35.8,66.5,25.6,25,22.1,22.5,138.4,133.7,70.2,53.6,14.2,10.6,11.2,11.5,43.1,63.5,82.3,255.6,169.3,131.2,75.3,43.2,29.8,114.2,78.1,129.9,23.8,17.7,31.4,54.6,55.5,56,54.4,55.9,56.3,56.4,56.6,56.6,54.9,34.4,8.6,9.2,103.4,9.1,9,19.7,59,61.7,19.2,14.1,12.1,94.8,214.1,68.1,37.9,30.6,31.6,29.7,27.2,31.7,23.9,30.8,24,80.8,164.8,174,88.2,50.8,146.9,52.5,40.8,86.5,127.6,19.7,27.6,13.8,33.5,58,54.6,57.1,56.2,55.2,56.9,65.3,61,58.8,56.2,35.5,22.1,228.6,230.3,58.1,22,16.2,16.4,17,17.3,16.8,16.3,16.2,16.2,17.4,17.6,15.1,14.3,15.8,18,16,24.9,15.4,85.4,59.4,97.2,54.1,38.2,124.8,116.3,54.7,54.1,22.9,46.3,163.2,17.2,10.1,33.1,56.9,55.9,56.2,57,63.2,57.5,56.4,54.9,54.3,55.3,41.6,41.1,217,86.3,40.8,31.8,18,16.2,16,15.9,15.9,15.8,15.6,15.6,14.1,16.2,16.8,16.8,16,14.2,15.2,16,14.8,13.4,14.7,15.6,13.4,12.3,14.7,127.3,41,55,53.6,44.8,32.9,184,40.8,34.5,57.8,58.5,54.7,55.5,55.4,55.4,54.1,53.9,53.9,53.1,47.3,136.6,33.9,172.9,16.2,11.4,10.7,10.9,10.6,10,9.9,10.4,11.1,11.3,10.7,9.9,9,9.7,11.2,10.2,10.5,15.8,17.9,12.3,20.9,13.8,34.1,276.1,65.8,39.2,176.8,35.8,40.2,23.8,18.9,13.1,10.6,30,53.9,54.2,54.1,53.7,53.7,53.7,53.5,52.8,53.9,54.6,44.3,116,67.4,33.3,37.3,22.1,11.3,115.9,70.9,14.6,13.7,22.3,16.3,15.3,15,14.8,14,13.6,20.9,17.9,15.4,22.2,20.1,16.9,18.6,93.4,34.8,133.9,47.6,44.2,134.1,144.9,123.1,23.7,100.5,114,89,49.1,56.9,55.2,153.4,54,54.3,54.5,53.2,54,53.3,52.8,34.9,23.2,37.2,222.2,81.9,13.1,12.6,9.7,9.4,10.1,10.3,10.2,9.9,9.3,9.2,9.4,9,9.6,10.6,9.2,8,7.5,9,9.2,12.7,13.9,24.7,25,44.5,143.1,34.9,27,31.9,32.4,29.1,28.9,22.4,44,56.8,54.2,54.4,56,57.4,54.8,54.6,54.8,54.6,54.7,35.7,8.3,9.7,50.5,78.5,20.3,65.3,215.1,86,13.6,60.2,17.4,26.2,48.2,112.9,55.7,34.7,25,25.9,27.5,22.5,158.2,235.1,53.9,25.4,35.5,95.9,89.8,91,52.8,55.5,197.4,32.7,39.6,22.8,22.4,22.6,123.1,81.1,53.6,54.6,56.4,53.1,53.6,55.7,55.2,55,53.3,34.4,7.4,9.4,9.9,9.8,20.8,55.6,27.6,129.3,129.1,20.6,25.9,50,124.7,189.7,44.9,21,18.8,23.4,20.6,264.4,284.8,105.9,33.8,30.5,43.4,47.3,42.3,43.7,38.4,76.4,236.1,85.7,40.4,32.5,45.1,37.1,47.5,61.6,60.1,58.1,55.2,56.2,56.5,54.6,54.6,56.3,94.3,98,23.2,39.8,198.8,34.4,32.4,11.8,31.5,30.8,16.7,13.8,57.6,68.8,9.7,10.9,10.7,8.8,8.3,23.2,16.6,15.1,22.1,14.9,12.9,15.7,24.2,23,18.3,113.7,16.2,25.4,51.2,22.9,33.1,35.8,31.4,17.3,31.7,55.1,53.3,54.5,55.6,55.4,56.7,56.2,67.3,59.2,58.9,35.5,31.8,108.4,211.2,99.2,32.6,28.7,16,11.3,11.3,12.8,16.9,80.2,124.9,43.2,83,167.3,142.3,136.4,168.6,110.7,14.3,14.7,25.1,16.2,15.2,12.8,13.4,31.3,27.6,39.1,46.2,27.6,53.5,114.8,18.7,14.9,35.3,59.8,58.5,59.8,60.4,57.8,57.4,57.8,57,58.2,56.8,36.3,20,140,198.8,36.4,32.5,27.8,18.5,17.4,57.7,21.3,162.4,18.2,18,16.6,19,14.5,15.7,18.5,16.3,15.6,27.2,22.2,26,36.7,64,85.4,101.8,21.2,156.9,241.3,52.4,37.6,43.3,38.4,160,25.2,32.1,57.1,57.3,58.3,55.2,57.6,59,57.9,56.1,56.5,56.4,36.1,18.1,132.1,171.5,12.4,10.3,9.9,9.8,9.5,106.7,103.4,14.8,14.3,19.7,13.2,14.1,13.8,11.9,8.6,34,141.7,105,58.9,24.8,20,31.4,25.2,129.7,102.6,82.7,44.1,35.9,30.6,168.5,154.7,81.5,47.9,32.3,56,58.2,56.8,57,56.3,58.7,56.7,56,55.9,54.5,37.1,23.7,102.3,156.5,108.7,132,18.3,21.6,16.3,21.8,133.3,34.5,13.2,22.8,15.8,15.6,15.5,20.6,17.2,15.2,14,13,27.5,24.3,17.9,18.8,62.7,147.7,36.2,40.2,36.4,33.1,30.4,44.6,32.7,31.3,24.8,44.9,63.1,56.1,56.5,55.8,55.5,55.1,54.9,151.3,53.9,55.8,36.7,8,7.5,7.5,11.3,34.4,62.2,174.8,52.6,24.9,56.1,17,17.6,21.6,37.3,138.5,97.8,64.2,64.1,63.6,69.3,63.4,83.9,79.1,70.1,27.4,291.2,193.2,34.2,76.5,63.5,42,25.7,123.8,128.6,59,86.1,19.2,18.8,14.9,58.8,52.9,53.2,54.6,52.5,52.5,53.4,54.1,34.4,7.1,6.9,8.3,7.4,9.5,19.3,31.1,252.6,88.5,12.8,25.6,22.2,21.1,41.3,129.5,46.6,22.7,26.7,21.8,19.5,18.8,39.4,73.5,312.2,138.3,31.8,46.2,123.6,247.8,233.3,66.5,23.7,29.8,21.1,14.5,8.4,8.1,8,11.5,54.2,54.5,54.5,53.9,54,53.9,53.7,53.5,34.5,128.1,13.1,42,156.1,10.5,18.7,16.9,15.6,15.3,15.4,21.1,20.7,23.3,19.9,21.6,20.4,20.5,27.4,17.3,17,109.5,21.6,27.8,35.9,45.1,109.6,99.5,84,89.7,120.8,19.3,18,25.8,12.8,8,7.9,7.8,7.8,11.4,54.4,53.1,55,55.6,54.5,55.7,56.1,56.4,36.1,84.6,59.9,183.9,81.6,35.8,20.5,13.9,21.7,176.8,18.5,15.9,14,13.4,15.2,22,14.8,14.2,12,10.8,12.2,12.9,12,16.7,27.1,15.9,185,39.9,38.3,36.6,48,35.8,142.2,33.1,24.8,16.9,12.6,17.8,42.2,87,56.4,56.1,55.7,55.3,54.9,56,55.1,54.4,37.2,33.8,221.1,112.3,32.7,15.4,10.1,10,10,12.3,21.5,190.4,13.7,14.4,19,13.5,12.3,10.6,10.2,21.9,12.3,105.6,23.2,12.4,9.8,9.8,146.7,105.1,66,26.8,53.7,169.5,42.2,66,113.2,73.8,41.8,118.7,8.7,12.1,55,55,55.7,55.5,55.4,55.9,55.4,55.4,36,19.4,124.1,118.7,43.8,18.3,16.9,17.4,27,115.3,45.5,10.1,10.2,10.2,10.2,10.1,9,8.4,10.3,23.4,16.7,15.3,16.2,27.7,13.7,10.6,10.9,11.9,11.7,88,39.7,24,40,30.1,29.7,43.5,16.9,10.9,9.3,12.8,55.3,114.4,84.5,55.1,54.9,54.2,56,54.3,36.3,22.6,109.4,72.1,27.3,158,32.3,30.4,22,16,131.6,13.9,16.2,18.5,13.9,11.6,7.4,12.3,27.1,18.8,16.8,15.8,14.8,15.3,69.6,71.2,63.1,188.5,61.8,40,54.7,160.8,31.1,27.8,68.3,28.3,15.4,12.5,8.9,15,55.1,53.4,55.1,55.8,55.7,55.8,55.7,55.7,45.8,139.7,25.5,11.6,30.4,20.5,19.8,12.3,10.2,14.2,181.3,35.6,24.7,27.8,21.3,16.3,93.9,45.9,26.3,21.2,185,29,28.2,40.3,37.2,29.5,59.9,94.3,13.5,15.9,13.9,15.5,14.1,14.6,16.7,12.7,23.1,23.4,13.9,17.4,53.4,54.1,55.7,51.2,52.7,53.7,50.6,53.4,33.2,8.1,10.9,9.2,79.6,41.2,31.3,31.4,58.1,29,32.8,23,29.5,21.1,29.8,137.4,20.5,15.2,30,34.5,21.3,25.8,20.6,13.7,13.3,70.4,82,40.4,66.6,58,51.9,35,28.2,24.8,24.5,42.6,162.9,20.5,19.5,29.8,60.8,57.4,57.5,57.5,55.3,54.8,55,55.2,35.8,27.9,202.1,50.1,33.3,24.6,22.7,22.8,122.8,16.7,13.9,10.9,10.9,11.1,24.7,16.9,26,17.1,18,16,23.2,25,23.4,121.1,33.1,212.3,101.4,49.2,69,95.5,47.2,138,43.1,79.7,76.8,86,23.1,11,10.5,12.9,55.4,55.1,55.7,55.9,55.8,57,55.8,55.4,36.8,30.9,193.2,46.5,45.7,39.3,60.5,77.3,13.5,25.5,14.4,22.1,40.4,79,112.5,91.5,234.4,22.6,31.4,178.6,51,18,12.4,12.8,20.5,24.5,58.8,32.4,108.1,150.8,32.1,26.9,29.4,19.6,23.4,120.9,28.5,10.8,9.9,12.9,55.1,54.4,54,59.1,56.6,52.9,52.9,53.6,35,27.7,157.2,45.9,37.7,24.2,65.8,17.8,29.1,24.6,116.9,16.8,15.7,14.9,16.7,22.6,13.3,12.7,9.4,18.4,22.7,20.1,18.7,114.2,17.6,17.6,60.3,188.2,151.1,56,46.1,197.2,71.8,26.6,29.9,27.6,18.5,14.7,15.5,19.5,60.6,61,67.4,60.6,59.3,60,59.8,60.3,41.6,14.8,102.8,76.9,213.7,26.7,29.3,22.1,20.4,20.5,16.6,14.3,12.5,12.5,12.4,12.4,11.2,10.7,20.6,104,24.3,27.3,26.4,24.8,26.9,31.4,80.7,64.3,191.5,42.8,49.3,191.2,44,36.1,80.4,98.6,44.3,95.7,24.5,17.2,56.8,143.7,56.5,56.5,56.5,55.8,55.6,55.4,35.4,10.2,79.5,207.9,54.5,14.5,155.5,44,39,145,13.7,10.2,10,8.7,8.5,23.5,69.1,212.3,219.2,197.7,20.2,16.6,16.6,18.6,19.1,24.2,25.8,21,16.9,15.8,15.3,15.5,15.1,15,13.7,14.6,13.5,113.2,80.3,14.3,55.7,54.2,54.2,53.6,53.5,54.7,55.4,54.7,34,7.5,8.1,8.4,23.5,96.5,263.1,51.8,9.5,10.6,9.4,10.5,10.3,9.5,11,9.6,9,9.1,8.7,10.2,10.4,17.9,11.9,17.8,15.1,19.7,27.1,225.6,53.7,47.4,201.9,219.5,34,66.3,25.3,23.3,11.9,12,11,15.8,55.3,54.6,54.1,54.1,54.4,53.9,53.7,53.3,36.4,8.7,112,20.2,66,29.2,11.8,10.4,10.7,10.8,13.9,13.3,29.1,57.7,146.9,57.1,56.9,56.8,56.8,56.4,19.3,12.3,80.8,207.7,114.7,13.2,10.6,23,21.3,26.5,22.2,26.6,24.9,19.6,27.8,22,110.6,9.1,8,11.3,53.3,54,54.2,54.2,52.6,53.3,53.5,53.5,33.5,8.7,8,7.7,20.2,10.5,135.6,52.9,17,27.4,20,17.6,15.9,14.7,31.9,70.6,28.7,33.4,15.9,15.3,102.7,17.9,18.5,26.8,30.2,234.2,148.1,14.6,15.3,15.4,15.7,15.6,14.8,70.5,18.5,12.4,8.8,7.5,9.9,23.6,57.5,54.3,54.5,156.2,52.8,52.5,52.7,52.8,34.1,22.1,26.3,31.5,52.3,137.1,40.4,36.2,93.5,14.3,11.4,77.5,55.1,19.7,13.8,14.2,13.5,17.4,13.2,9.5,7.2,8.3,8.5,7.1,6.7,7.7,17.6,167.5,138.6,246.5,51.9,47.4,26.7,20.9,78.1,95.9,52.8,12.8,13.1,14.3,56.2,57.8,57.9,57.5,56.5,55.8,57.6,58.7,40,25.8,169.4,85.6,44.3,125.4,54.2,26.1,22.1,21.2,17.6,18.5,18.8,18.4,27.8,19.2,19.7,26.3,17.5,25.9,17.5,37.4,34,35.2,98.8,74.1,106.8,41.8,46.1,34,19.3,34.8,166,24.2,16.5,9.5,9.1,9.2,9.2,12.6,54.1,54.4,56.1,55.2,56,56.5,90.5,113.1,35.1,21,153.3,56.6,7,6.9,93.9,16.2,58.2,87.5,12.3,22.6,18,18.2,16.4,17.7,23.6,15.5,15,29.3,66.1,71.7,28.6,19.6,19.4,110.4,22.8,217,133.3,38.3,178.6,40.3,15.9,16.4,30.7,22.2,12.9,9.9,9.6,13.5,56.7,55.8,55.7,55.5,56.7,55.9,56.8,57.3,35.8,58.1,93.7,256.7,24.7,14.4,26.8,21.8,12.6,14.5,15.2,14.9,118,11.6,17.4,13.4,14.2,14.6,14.7,14.8,22.1,57,12.6,28.7,19.9,15,21.2,142.4,64,29.9,28.2,163.3,23.3,69.6,26.5,24.7,64.5,24.5,22.6,25,59.5,127.2,91.1,56.4,56.8,55.5,55.1,56.8,35.9,7.9,9.1,9.5,9.6,29,17.6,34.7,188.3,232.5,194.2,64.7,63.6,127,197.4,96.5,127.4,44.2,92.5,23.4,127.5,150.3,82.8,77,73.4,168.2,44.4,165.9,59.2,23.4,22.2,18.6,15.9,15.9,15.7,17,50.9,24.8,16,17.6,53.4,62.9,57.9,55.4,55.9,54,53.4,54.6,131.4,8.8,9.1,7.8,8.9,9.3,18.7,11.8,78.5,13.3,14.1,13.1,14.6,152.7,223.4,46,24.3,29.9,129.1,48.2,22.3,19.8,18.9,19,21.1,171.6,74.2,197.8,287.8,197.8,47.2,48.5,46.9,151.8,87.6,56.8,22,19.8,15.9,14.6,54.6,54.2,54.1,53.1,52.9,54.4,54.7,54.5,35,7.5,40.5,83.9,82.3,304.2,201,30.9,52.1,23.2,36.1,15.2,13.4,11.3,9.7,132.6,14.3,13.8,14,29.6,18.4,16,13.6,12.7,12.6,18.3,73.6,214.4,145.6,48.4,47.9,52.6,29.4,44,27,139.4,21.2,16.3,11.1,15.4,56.7,57,54.9,55.2,55.9,54.1,54.1,55.6,36.6,8.6,9.5,19.9,227.2,136.5,12.9,10.1,9.3,14.7,15.6,12.4,9.9,9.7,8.2,7.7,7.6,7.6,7.2,8.7,20.9,14.1,12.2,105.8,15.4,33,25.6,25.3,113.7,60.3,47.3,223.9,191.1,48.3,229.7,199.7,92.9,87,25.9,13.4,53.5,53.4,55.2,54.3,53.3,53,53.7,52.9,34.9,7.9,16.7,14.3,194.6,198.2,92.6,23.7,12.4,8.8,8.9,21.4,81.4,47.6,14.6,13.3,13,14.4,21.1,14.9,14.6,18.8,14.7,27.2,27.4,47.1,48,49.2,38.8,39.6,145.7,43.5,32.5,31,161.5,29,41.4,11.1,8.5,11.8,52.4,51.9,52.6,53.4,53.4,63.7,57.4,54.2,34,7.2,15.9,161.1,31.5,28.8,29.1,32.6,25.8,22.4,164.6,14,11,9.2,20.3,14.2,12.3,13.3,13.5,20.7,13.7,15.8,27.7,26.5,27.6,17.7,21.3,36.7,198.4,243,66,38.2,127.6,105.4,19.1,17.5,25.4,18.8,14.3,21.4,58.1,55.4,53.5,53.5,53.6,53.6,54.7,55.3,34,8.3,7,45.3,117.9,243.6,228.4,30,22.8,13.9,16.9,84.2,71.7,12.8,14.6,12.9,19.1,15.2,20.2,19.7,14.5,13.1,12.8,11.9,28.2,27.6,112,46.3,84.2,136.9,36.7,42.7,186.7,30.2,33,22.8,20.9,79.9,23.2,24,54.8,54.9,54.7,54.4,53.9,55.3,54.7,54.3,35.2,7.6,7.1,8.8,110.4,9.1,9.3,25,126,21.1,116.4,204.2,11.3,20,22.2,16.3,18.2,16.4,26.1,162.4,36.6,12.4,13.1,11.5,29.4,35.6,146.3,94.9,138.1,223.3,25,22.2,26.6,28.4,23.5,22.9,22.7,19.7,15.2,80.6,57.8,56.9,156.1,56.4,55.5,55,54.8,56.1,36.1,10.3,9.1,8.1,8.2,9.4,9.7,18.5,118.1,218.4,25.1,18.5,163,148.8,12.8,9.8,8.1,9.1,9.5,10.7,17.2,11,8,10.9,11.8,9.4,8.4,26.3,207.1,22,25.7,123.7,108,19.3,19.1,16.1,16,9.3,7.8,11.7,52.5,52.5,53.1,52.9,52.8,54.9,53.7,53.2,34,7.6,7.6,16.4,81.6,84.6,16.5,116.4,10.9,9.5,10.5,13.1,13.4,13.5,55.2,42.7,76.8,33.2,54.6,81.6,142,11.9,8.4,17.5,29,32.8,41.3,164.2,65.6,107.3,79.8,65.3,146.9,38.8,25.1,20.5,29.1,205.1,10.3,12.5,52.4,53.1,54.1,54.1,52.8,51.4,51.8,51.7,34.5,16.6,11,17.9,177.4,30.2,24.6,21.5,15.3,35.6,158.7,30.5,18.2,36.6,23,22.5,30.8,26.6,17.5,30.4,23.3,29.6,22.5,22,13.5,28.8,47.6,55,170.6,217.7,74,66.9,42.9,33.5,78.6,131.2,19.6,14.9,10.2,14.3,54.6,52.8,52.5,52.4,52.7,54.2,52.9,52.3,33.8,8.9,7.6,18.7,221.2,51.1,54.2,22.1,146.8,25.7,26.5,22.4,24.4,26,25.3,21.9,22.4,30.4,30.2,29,27.7,30.3,124,30.3,28.9,54.7,123.8,122.7,143,102.4,136.1,44.5,49.8,38.9,44.5,32.5,129.9,69.3,68.8,89.1,65.7,52.3,54.1,53.6,53.1,52.5,52.4,53.7,34.9,7.1,7.9,15,132.8,62.8,28.3,207.9,139.7,19.1,12.9,12.4,15.1,17.1,17.3,21.3,19.9,17.5,20.1,24.6,21,23.9,22.5,22.1,21.9,45.4,52.5,42.2,93.6,161.3,35.7,40,45.8,25.5,23.5,30.1,16.9,8,7.5,11.5,52.3,53.3,130.4,79.6,53.7,52.3,52.4,53.7,33.7,7.6,7.6,15.8,144.3,123,16.3,32.8,68.2,27.2,16.6,14.3,53.5,194,220.8,177.5,75.3,31.4,78.2,49.3,24.7,137.3,22.5,28.4,22.7,54.8,83.1,78.6,59.8,135.2,119.6,217.8,52,48.1,57.8,37.8,24,15.7,16.2,17.7,58.1,56.7,65.7,160.1,58.7,58.2,56.8,55.8,37.9,12.4,12.6,11.7,61,247.3,213.7,96.6,9.8,9.3,9.5,10.2,10.5,10.6,10,10.1,10,10.3,10,10.5,10.8,10.8,10.7,10.3,42.6,80.1,9.4,18.5,18.6,18.5,19.8,18.9,18.2,18.1,18.2,17.8,19.6,19.7,18.3,22,63.7,62.5,64.3,63.7,63.8,63.9,64.2,64.2,141.5,18.4,18.6,18.5,18.6,19.8,19.9,20,19.7,19.9,15.5,10,10,10.1,9.3,8.8,9.9,10.4,10.3,10.2,10.1,8.6,8.3,8.3,8.3,116,8.2,8.6,9.3,9.2,9.2,9.2,10.3,9.2,8.8,8.4,8.5,9.7,8.7,12.6,54.9,53.6,55.1,55.3,55.2,54.3,55.4,55.9,35.1,17.5,112.8,19.3,13.2,10.1,10.1,10.4,9.8,9.7,9.9,10.4,10.6,10.8,10.9,10.4,10.4,10.4,10.4,10.4,9.1,8.7,8.7,9.1,9.1,9.2,9.2,8.9,99.6,148.6,58.7,38.4,43.4,90.4,41,35.9,36.9,50.8,49.7,23.3,58.6,153,70.4,55.6,54.7,54.4,54,54.4,36.8,9.7,67.5,199.8,8.2,9.1,24.6,49.4,22,183.9,72.8,28.2,20.7,14.6,20.4,14.4,12.5,19.7,14.1,13.8,13.8,12.4,20.5,12.8,14.6,13.6,24.2,109.5,32.6,13.7,13.5,14.7,13.5,12.7,12.9,30.4,25.9,30.6,12.2,13.2,53.5,53.2,53.5,120.4,88.1,54.7,54.6,53.8,34.6,8.3,8.3,20,161.1,89.8,13.7,116.6,228.8,182.3,13.3,10.6,10.8,11.2,9.6,22,12.5,14.8,24.3,20.2,21.8,24.9,25.1,128.9,13,14.4,18.3,84.2,187.9,72.1,156.3,250.1,32.3,35.5,72.9,31.7,24.9,26.6,14.6,34.2,139.6,58.2,57,54.4,53.1,55.5,54.6,52.8,33.2,7.1,7,6.9,8.5,7.5,21.6,14.4,17,29.3,118,19.3,28.1,25.9,18.2,122.9,157.8,29.6,24.2,32.6,20.2,21.3,31.3,21,105.9,72.7,67.8,356,348.3,55.3,36.5,66.2,193.4,22.6,77.8,31.5,23.7,104.2,51.2,97.7,61.9,53.1,52.6,52.8,53.4,53.2,53.4,53.7,35,8.1,33.7,207.1,23.9,15.6,36.9,41.1,119.7,14.2,15.8,35.1,250.5,214.9,19.5,17.3,17.2,20.7,28.7,16.7,18.7,21.6,39.4,22.1,29.6,72.5,74.5,73.4,100.8,44.2,93.9,144.6,36.8,28.1,34.6,20.3,46.9,58.8,31,113.3,52.6,51.9,52,54.3,54.5,55.8,56.3,56,36,8.1,7.9,8,20.9,59.9,110,144.8,204.2,136.6,13.8,13.2,12.7,22.5,13.6,13.1,15.9,19,32.7,101.8,18.2,14.8,16.4,15.8,14.7,14.2,14.3,33.7,33.3,22.4,22,23.2,145.3,211.9,137.2,62.1,26.3,14.7,12.7,23.2,152.7,52.6,53.2,52.6,53.9,54,54.1,54.4,34.6,8.3,9.7,8.6,8.4,19.2,12.3,19.5,30,29.1,23.6,20.3,20,111,31.8,26.2,43.4,17.7,22.8,40.8,134.5,79.9,208.5,149.1,28.6,23.4,33.2,52.4,148,174.2,50.5,174.4,40.6,29.2,33.7,46,103.7,152.6,42.1,89.8,13.3,13.5,55.1,54.8,54.7,54.8,54,54.3,54.3,53.9,36,143.1,66.4,13.3,17,229.5,212.4,23.7,23,38.8,53.9,29.7,31.9,33.7,27.5,42.7,112.8,30.4,34,36.6,31.5,29,25,37.6,116.2,333,110.1,117.4,139.2,131.7,79.9,203.8,49.7,50.2,45.4,88.5,24.3,21.8,10.7,14.6,54.6,54.6,55.9,57.2,57.1,116.9,88,55.4,37,16.6,105.3,258.2,246.2,80.3,26.6,14,11.9,11.8,38.6,30.4,13.6,11.2,11.8,11.8,11.8,19.9,96.1,9.2,9.1,10,10,29.1,32.9,27.7,20.5,18.6,157.8,188,49.3,41.6,38.6,44.1,126.4,177.7,91.6,25.9,10.3,15.5,57.2,56.6,55.7,55.4,55,56.1,54.8,55,35.2,73.9,242.9,161,53,26.9,16.5,15.7,16,95.2,85.4,15.8,16.3,15.6,24.4,16.1,16,14.9,23.6,22.2,22.6,25.9,31.5,31.7,189.4,99.2,85.1,95.5,31.5,139.2,240.7,48.1,36,20.2,19.4,13.8,13,14.2,17.7,17,55.3,54.7,54.4,54.4,54.8,55.1,56,54.5,35,18.7,24.2,251.9,229.4,205.8,13.4,10,10,9.9,19.5,14.3,18.4,15.6,19.8,18.9,15.3,13.8,14.9,23.8,14.4,22.4,119.8,29.8,29.2,25.8,26.8,147.5,157.7,147.5,233.7,42.8,53.2,27.1,30.2,142,15.4,9.8,9.7,14.1,57.1,63.8,58.1,54.7,53.3,53.2,55.6,54.2,35.5,28.7,198.5,273,145.8,34.7,13.4,10.2,9.9,10.2,9.8,10,10,22.8,118.2,13.4,13.7,22,16,16.3,21.7,13.3,37.7,27.6,116.1,138.3,69.9,64.2,123.2,45,35.3,33.5,150.6,74.3,160,94.4,47.2,15,14.7,18.5,154.1,57.8,56.9,56.2,56.3,57,57,56.9,37.6,13.8,125,214,94.9,25.7,30,21.8,34.4,16.8,14.8,154,198.6,15.9,32.4,23.8,28.3,153.2,75.6,71.8,70.8,70.1,44,36.6,136.5,39.8,207.6,121.1,32.3,180.2,71.1,74.5,15.1,11.8,10.3,9.8,8.5,8.2,8.1,12.6,53.8,53.5,54.3,54.1,54.3,53.7,61.3,141.8,33.8,8.3,8.3,9.2,20,13.6,11.8,9.9,10,9.9,15.3,27,149.1,188.7,60.7,30.7,19.7,71.3,121.8,23.1,24.1,12.3,12.9,24.3,183.7,127.5,107.2,34.6,71.9,217.3,65.6,39.8,157.8,112,18.9,9.2,8.7,8.3,8,12.5,53.8,53.1,52.8,53.2,53.1,54.5,55.1,54.9,35.3,55.4,166.1,214,189.3,119.5,16.1,10.9,10.4,25.1,18.1,16.3,14.6,14.2,115,77.6,37.4,20.9,65.1,38.5,17.1,12.5,11.5,17.7,107.4,227.5,107.4,51.5,130.7,99.5,51.6,36.1,42.3,70.7,23.5,16.7,15.4,8.5,9.5,66.5,94,53.6,53.9,54,53.4,53.7,53.8,54.3,34.9,18.1,38.2,229.7,212.4,19.1,11.3,10.9,18.1,16.2,23.1,118.2,32,14.6,193.5,165.2,149.6,89.8,191.2,74.4,184,61.5,15.1,14.6,15.8,106.2,77.1,45.3,49.3,35.9,33.4,88.2,269.3,139,44.1,24.8,21.7,70.9,9.3,15.5,54.9,54.5,53.7,64,57.7,54.6,53,53.2,34.6,20.6,70.8,232.2,162.2,44,21.9,19.6,20.1,64.5,17.8,14.4,13.6,102.5,52.6,51.9,15.9,19.7,17.3,14.3,12.7,22.8,27.9,26,154.6,89.1,136.9,36.8,29.5,42.7,31.6,39.6,46.4,30.7,25.9,21.2,10.2,8.2,8,110.3,55.2,55.5,55.3,53,53.5,54.2,54.8,53.8,35.4,23.5,101.2,211.2,105.8,105.5,34.6,13.7,122.2,19.1,24.1,18.3,13.9,11.2,9.9,22.2,82.3,46.9,13,13.2,29.7,27.5,29.1,44.5,47,37.1,23.6,22.3,22.4,91.4,56.8,19.1,19.1,60,36.1,12.6,11.4,10.5,10.2,13.2,55.5,56.3,55.2,54.1,53.8,150,54.8,54.1,35.3,8.9,23,145.4,236.8,71.6,18,14.3,12,20.4,194.5,83,12.6,12.4,15.5,58.7,53.4,15.5,15.5,14.7,13.6,14.3,15,37.3,65.8,193.8,124.1,47.5,52.9,55.9,31.9,32.9,144.1,34.2,25.1,24.4,10.6,9.1,8.9,14.1,55.5,55.4,55.4,55.5,54.5,150.1,54,53.1,34.1,8.2,8.3,10.9,132.9,255.5,118.7,39.7,12.9,137.2,10.9,11,26.3,212.3,106,35.4,17.6,15,9.1,7.7,15.2,15.5,126.6,69,43.4,42.9,230.5,20.3,15.7,23.2,40.6,34.9,40.8,20.3,19.8,78.4,25.4,24.7,24.5,21.9,54.3,52.9,150.9,54.8,54,53.9,54.8,55.6,35.4,8.5,8.6,9.4,29.5,49.5,72,26.5,130.6,326.2,66.7,34.7,48.9,22.7,31,25.4,165,198.1,23,24.6,137.8,84.8,31.1,58.4,56.8,231.9,255.5,46.1,108.9,59.7,76.3,137.1,39.6,181.6,169,10.1,9.2,8.5,10.4,15.1,55,54.2,53.4,52.7,52.7,52.5,52.6,52.8,35.4,60.4,236.1,104.4,81.1,140,9.9,10.2,10.3,10.1,9.9,9.9,9.9,10,10.3,10.2,9.4,9,13.5,10.9,8.6,23.3,18.4,57.1,386.4,205.6,162.6,119.2,97.5,115.1,194.9,51.2,29.6,109.2,122.4,65.9,65.1,21.9,14.2,17,57.8,56.5,55.9,54.7,54.5,55.1,144.6,56.9,39.7,25.8,116,250.2,71.9,35,14.9,8.8,9.6,11.1,23.6,15.7,103,15.7,24.3,15.2,13.6,14.5,23.1,13.1,19.7,19,11.9,11.7,31.2,185.9,203,85.2,136.7,49,181.9,67,39.6,78.1,179.5,37.7,11.1,9.4,9.2,13.1,63.5,56.9,53.8,53.4,53.2,53.9,54.1,53.6,34.4,9.2,59.6,227.7,126.7,142.1,142.5,9.3,9.3,9.6,9.7,11.9,25.2,14.3,14.7,22.5,36.5,86,14.2,12.7,28.5,163.5,128.8,33.3,204.7,133.3,172.1,98.6,291.8,300.3,293,188,52.7,164.4,28.7,16.4,8.9,10.1,9.9,13.8,55.5,54,53.9,57.8,58,54.9,85,113.2,33.7,31.9,194,231.5,134,34.9,17.1,14.3,21.5,27.4,69.8,81.9,11.4,90.2,104.6,43.9,14.4,26,19.5,14.3,82.9,34.5,30.5,193.1,228.2,51,45.7,179.4,100,46.1,205.3,242.6,85.4,71.6,17.4,22.7,14.8,11.7,9.1,13.9,53.9,54.1,54.1,98,105.6,53.5,54.7,54.4,34.1,141.5,267.2,234.5,83.7,35.9,16.2,18.7,19.9,17.6,15.4,14.9,16.1,16,26.5,155.9,12.4,9.7,8.9,51,48.1,75.1,152.9,61.5,39.7,22.8,23.7,46.8,55.4,46.9,252.7,264.8,107.6,25.5,24.3,16.2,12.5,11.6,11.5,16.1,57,57.1,57.4,86.8,200.1,62,61.3,59.5,39.8,11,36.2,77.5,10.6,15.8,298.6,61.5,17.7,152.7,215.7,176.1,14.4,47.7,61.7,57.1,117.3,35,26.3,47.3,41.7,25.9,27,30.1,46.1,220.8,263.3,133.7,227.7,260.3,373.8,265.5,27.2,28.4,14.5,9.1,8.9,8.6,18.4,15.5,54.7,54.1,52.7,52.6,52.7,52.8,52.9,129.1,7.8,7.9,7.9,9.4,70.1,82.1,96.6,145.4,60.4,102,24.2,13.5,221.5,128.8,36.4,20.3,249.9,217.5,84.3,15.6,41.3,59.5,22.2,255.1,377.4,295.9,263.3,349,376.2,179.1,181.9,98.7,30.9,102.9,37.2,15.3,13.1,12.5,10,13.1,139.5,53,53.9,54.1,54.1,53.7,53.7,31.6,8.9,155.7,318.6,172.5,77.7,32.3,18.9,10.8,9.7,9.5,9.2,8.6,9.8,9.9,9.8,13,94.5,9.7,22.5,12.7,10.3,9.7,9.8,21.7,338.8,267.2,250.5,241.4,284,430,222.8,36.4,86,75.7,313.4,157,91.7,22.2,8.6,12.8,54.3,54.5,55.2,53.5,53,55.4,54.9,31.2,7.9,246.9,162.5,30.3,48.4,29.8,14.3,12.2,117.1,14.9,81.1,18,31.8,26.1,231.4,51.3,152.3,179.7,237.3,71.6,156.8,22,82,33.7,20.2,30.9,85.4,54.5,146.2,218.1,64.7,45.4,44.1,26,31.6,85.2,42.6,8.3,8.2,12.5,53.7,54.8,52.9,55.8,57.3,53.4,52.9,31.4,7.9,246.7,308.8,83.1,242.7,143.6,36.5,23.1,23,30.5,15.4,16.1,23.1,13.1,10.9,8.6,44.9,63,29.7,264.4,300.7,43.6,87.2,35,272.2,342.4,312.5,198.5,190.2,197.1,61.8,67,27.2,144.1,22.5,13.1,9.5,18.8,12.1,13,55.9,54.9,54.7,54.8,54.8,55.2,53.3,32.9,10,216.3,241.5,235.8,63.2,15.8,13.3,9.8,8.9,12.7,157.1,164.8,34.3,103.3,104,67,13.2,28.6,82.6,30,20.4,36.2,138.2,60.8,30.7,82,56.8,21.6,20,19.7,182.9,278,158.9,134.4,80.8,17,10.6,12.7,10.6,14.5,54,53,53.9,155.6,53.9,53.1,53.6,30.9,7.6,40.5,365.4,296,85.5,16.8,11.2,10,9.6,9.7,9.7,10.1,10,15.2,13.2,110.8,16.5,13.2,12.3,25.5,122.2,19,182.1,132.9,127.7,131.4,204.3,310.2,243.3,197,204.4,195.1,92.9,141.7,23.1,22.4,20.5,18.6,98.8,62.9,139.5,65.7,54.1,53.7,53.3,54,54.2,31.3,94.4,8.1,7.9,9.1,12.2,28.6,48.7,32.4,34.7,29.5,127.8,30.5,199.1,19.1,19,42.1,93.4,201.1,174,12.4,31.9,33.7,22.5,23.3,16.6,17.4,172.8,128.7,42.3,18.1,16.3,131,256.5,129.5,20.5,137.1,59.6,39.1,14.4,14.9,55.9,52.9,52.7,52.7,52.9,53,52.2,30.2,7.3,104.5,8.1,8.9,8.9,8.7,20.7,21.2,14.2,52.6,41.7,97.3,231,115.5,26.4,22.5,271.3,124.8,24.6,34.4,54.4,44.4,97.9,193.1,340.3,90.2,271.8,379.2,195.1,177,173.1,144.3,191.6,28,46.1,90.9,23.3,12.9,10.7,109.5,125.8,94.2,56.3,55.2,55.3,56.1,55.9,99.7,30.3,23.6,19.6,110,150,34.7,12.4,9.5,11,15.7,68.7,16.4,15.8,125.3,91.1,15.8,15.5,56.4,73.5,13.7,13.7,33.1,35.5,94.3,223.1,268.7,322.6,188.3,164.8,230.7,72.1,89.4,81.5,32.7,50.4,104,64.4,57.9,92.6,24.9,57.1,55.8,56,55.1,55,56.5,56.3,33.8,10.4,18.8,118.6,193.7,309.5,245.9,127.9,27.7,27.7,67.6,103.7,64.9,23.8,33.6,24.6,24.7,47.4,83.4,80,41.5,25.1,22.7,22.5,33.6,123.9,442.7,229.2,149.7,119.3,136.9,272.2,59.3,45.4,24.4,20.1,24.9,54.4,14.4,12.3,16.9,56,54.7,54.8,55.8,54.3,154.5,54.8,32.4,9.9,43.1,258.8,215.3,145.4,35.9,13.5,10.2,10.1,10.2,130.5,34.7,226.8,15.9,14.2,12.2,9.2,80.2,36,36.3,85.8,85.1,125.1,190.4,170.9,152,233.3,90.7,191.1,314.9,269.6,44.7,21.9,75.4,24.6,16.7,13.3,89.2,49.9,15.3,56.3,55.9,56,56,56.4,56.3,56,33.1,11.3,18.7,121.3,171.5,232.2,122.1,32.6,28.3,25.3,39.8,156.7,15.5,13.1,10.1,9.5,16.4,10.6,9.6,7.6,7.8,7.9,28,27.2,65.5,34.2,25.1,148.3,275.6,88.5,28.4,48.4,184.3,103.7,28.5,83.9,101.3,36.4,13.6,10.4,14.9,56.7,56.5,56.2,56.2,56.5,58.3,56.5,33.9,12,21.2,93.3,249.8,163.2,33.8,16.3,13.4,13.4,197.1,15.1,22.3,15.4,15.2,16.6,15.8,21.2,14.1,14.2,13.2,13.2,12.7,43.7,37.3,181.5,409.1,115.7,33.7,147.8,209,144.7,180.3,143.2,57.6,131.1,64,81.4,42.8,29.4,75.5,58.1,58.4,54.8,54.4,54.3,147.3,54.5,31.2,8,8,9.7,9.5,17,32.2,77.6,161.4,10.4,10,10,10.3,16.7,198.4,120,17.1,25.4,222.6,94.2,107.5,38.5,72.9,200.7,218.4,91.4,82,208.2,13.8,13,11.6,11.7,12.1,61.7,121.9,107.5,30.4,17.8,15.2,11.4,13.8,54.1,53.8,53.6,53.1,53.7,54.2,52.8,30.7,8.1,8.4,8,107.3,13.9,35.3,22.1,26.6,19.2,107,120.7,106.6,350.3,352.3,188.2,262.1,206.2,380.6,310,178.2,58.2,58.3,25.7,196.6,338.7,411.9,269.1,85.4,26.5,36.8,243.2,422.8,209.5,50.4,138.8,81.2,15.6,10.6,11.7,15,54.8,55.2,54.9,54.3,55.6,153.5,54.6,32.4,9.5,17.4,15,174.8,239.2,179.8,11.6,42.6,112.4,34.3,16.4,13.3,11.5,36.7,157.6,91.8,50.3,12.2,121.1,72.4,14,13.9,29.9,19,41.4,84.6,264,137.5,113.3,72.8,85.5,82.3,108,46.3,93.9,14.8,103,10.7,10.3,14.7,55.3,55.4,55.8,57.4,57.4,57.5,57.5,33.6,11,11.9,23.1,221.8,320,59.8,32.1,13.3,10.7,10.9,11.2,24.4,24.4,139.6,34,64.4,274.9,145.2,53.4,165.7,205.4,34.9,12.8,29.4,48.4,22.4,18.4,173.9,195.4,338.7,234.9,308.4,241.8,149.9,110.9,76.5,71.6,9.1,8.3,12.8,53.6,53.4,53.5,53.1,52.9,68.9,138.9,30.1,8.9,234.5,259.5,260.6,258.2,39.1,16.3,16,23.2,14,15,15.1,21.2,15.1,91.9,37.3,18.1,44.6,233.1,120.9,12.2,45.8,189.9,242.6,161.7,312.2,247.4,155.5,171.1,226.3,215.6,234.1,234.4,75.7,69.3,17.5,8.9,10,8.6,14.4,53.2,53.2,53.8,53.8,55.5,55.2,53.5,31.4,8.1,18.4,146.5,229.8,48.9,17.5,13.4,10.7,13.7,15.8,19.8,115.5,160.7,23.3,170.9,187.2,113.5,19.9,19.9,27.2,43.6,148.1,138.7,101,218.9,132.9,139.3,193,98.1,197.7,369.3,324.7,123.5,44.4,42.8,21.3,15.8,13.5,118.4,13,53.7,54.2,53.9,54.6,54.9,55,54.9,33.2,9.4,18,64.8,249.2,241.4,209.7,45.9,9.4,9.5,9.4,9.7,9.8,9.7,9.4,9.5,16,13.6,24.5,36,165,90.6,62.1,50.8,37.4,41.9,43.8,150.8,160.6,42.6,119.9,140.3,27.7,40.1,66.6,105.7,55.8,28.3,27.5,17.5,131.4,55.2,55.3,54.8,54.7,55,55.3,57.6,39.6,10,8,8.1,8.1,8.8,10.6,10.1,24.8,46.7,182.4,13.6,13,15.9,24.7,26.8,95.8,55.7,27.3,90.6,212.4,222.2,116.2,30.4,172.5,226.5,141.5,103.2,155.7,128.4,128,206.3,66.3,211.3,194.2,183.2,25,18.7,11.2,8.1,13.9,54.1,52.9,52.8,52.5,52.3,52.9,53,30.9,9.3,101.8,7.7,18.6,26.3,23.1,85.8,39.5,215,73.1,23.8,20.8,24.8,98.3,42.8,40.1,32.8,31.3,131,39.6,212.1,109.2,68.7,385,287.8,195.5,339.7,225.3,80.1,232.5,216.2,108.5,63.9,92.2,75.6,59.1,16.8,10,8.2,12.6,53.4,53.1,53.4,53.4,54.2,55.1,111.9,79.4,8,9.1,8.2,9,21.3,28.4,90.6,21.7,95.8,235.7,36.5,32.4,22,169.2,95.5,29.7,20.6,25.7,175,129.1,219,215.4,67.5,240.4,429.3,165.4,192,290.5,72.7,155,173,96.4,138.3,52.5,33.2,15.6,10.8,10.5,10.5,14.6,55.4,55.3,56.8,55.9,89.3,114,55.4,35.1,11,90.6,305,257,321.2,86.8,101.6,25.3,61.3,36.1,13,9.8,24.4,15.1,29.8,13.3,13.5,102.1,15,13.3,55.1,144.8,64.6,29.5,19.8,19.8,20.3,20.3,87,42.9,135.7,220.2,213,172.9,217.9,72.7,81.6,47.2,11,14.5,54.1,54.3,53.5,54,54.1,64.1,58.2,32.9,18.1,21.8,328.3,270.9,292.1,135.9,44.1,24.1,21.4,15.6,16.6,111.9,59.9,107.7,78.2,72.2,13.5,10.9,9.9,9.7,9.7,126.7,148.3,129.9,216.1,227.1,274.9,97.6,306.6,194.4,288,296.4,84.9,29.2,32.2,18.4,11.4,12.7,12.6,17,57.4,56.5,56.8,57,58.5,155.8,58.7,34.4,22.2,142.7,374.9,192.7,254.7,208.6,24.9,15.7,13.9,12.1,8.7,125.5,24.4,18.5,15.3,72.8,80.5,42.2,22.3,12.2,84.7,57.5,128.2,159.9,60,269,291.9,192.9,241,205.2,217.8,56.5,53.7,60.6,16.7,13.3,10,7.9,100.7,13.3,54.6,54.1,53.1,55.6,56.1,53.1,53.4,33.3,12.6,13.2,199.6,341.3,179.7,34.2,189,87.6,9.1,14.3,79.5,16.9,14.7,20.9,15.3,128.5,28.3,18.4,10.8,7.1,6.9,102.6,68.9,60.8,281.3,257.2,333.1,109.5,261.9,219.1,32.8,38.7,78.7,89,73.1,15.6,11.3,9.5,9.9,14.3,52.4,52.8,54.7,55,55.2,55.1,53.6,32.3,9.6,8,105.6,35.3,43,52.5,11.8,10.2,135.7,23.5,103.8,243.7,216.3,220.6,249.3,56.8,45.8,13.6,10.1,13.2,14.8,259,428.7,389.6,331.7,219.5,215.6,215.3,217.1,212.2,211.3,39.6,40.6,140.2,65.9,17.1,16.3,108.2,14.4,13.2,52.8,52.1,52,55.4,55,53.5,53.6,30.6,8.2,8.1,8.2,178.6,313.8,305.4,142.1,15.7,15.7,15.8,15.8,15.7,16.4,16,15.8,15.9,14.5,31.4,15.7,15.9,12.1,112.3,174.9,382.6,346.3,415.8,281.3,180.4,227.7,124.3,32.7,25.2,35.9,23.2,11.4,8.3,8.3,8.4,8.3,12.8,88.3,107.9,52.7,52.9,53.9,53.4,53.8,40.7,13.6,167,360.1,399.8,70,23.5,21.9,33.9,9.4,9,116.7,102,98.6,81.4,70.6,68.5,77,69,56.1,15.7,12.5,48.9,164.4,36.8,344,341.8,347.4,226.5,251.4,239.9,376.1,243.5,225.4,90.9,31.7,23.1,11.1,10,8.1,12.7,53.4,140.5,53,53.3,53.1,53.4,55.2,30.6,7.8,232.1,337.9,253.3,92.8,12,9.2,12.7,58.8,91.8,55.9,17.2,16.8,203.5,74.3,125.5,245.4,110.5,180.5,244.1,33.2,34.6,30.7,448.9,415.4,203.9,12.3,13.3,13.3,12.4,13.3,13.2,12.4,51.8,281.3,216.3,21.6,13.4,79,42.6,52.3,53.9,53.1,52.8,52.9,52.8,52.9,30.5,8,9.5,267.2,144.3,239,66.1,12.9,12.7,23.4,18.7,13,16.1,21.3,106.1,46.8,20.9,34.8,78.3,14.5,114.7,234.6,227,213.5,125.9,547,250.8,204.8,244.3,381.6,262,355.2,403.5,320.3,225.1,26.9,20.6,13.8,10.6,67.4,14.2,55.8,55.1,53.4,53.3,53,53.2,53.2,127.7,7.2,44,254.3,184.4,241.2,115.2,11.4,22.1,138.3,92.8,10.8,18.9,16.9,14.8,106.1,30.2,91.8,77.8,68.2,66.3,16.1,63.2,16.9,157.6,234.2,218.6,445.7,342.8,322.6,232.5,379,386.1,51.3,99.9,94.9,76.6,94.2,28.5,11.1,14,53.8,52.6,53,143.1,55.1,64.3,59.1,31.3,8,182.5,306.8,225.3,157.9,35.7,26.6,12.6,29.2,135,12.1,14.8,15.3,14.3,82.9,53.6,14.3,37,73.6,10.8,31.9,82.2,56.6,267.8,318.8,369.8,329.1,422.7,277.7,403.5,127.5,20.6,25.4,76.7,49.1,22.2,14.1,9.7,9.4,14.1,54.7,54.6,54.6,150.8,55.4,55.8,54.4,31.8,9,9.1,48,42.7,20.2,256.8,257.3,203.2,129.7,17.1,20.2,13,13.8,19.5,138.6,199.4,22.4,20.2,18.8,189.2,220,142.7,23.2,229.5,211.4,256.5,361.5,296.5,190,93.9,205.6,197.7,199,122.9,34.7,23.3,16.2,102.6,13.4,17.8,57.6,56.8,56.5,56.9,56.9,56.6,55.5,33.3,11.5,12.7,12.8,13,12.8,11.1,12.3,107.4,19.5,27.5,12.1,90.3,63.1,36.3,221.6,18.7,15.2,68.2,81.9,82.6,393.6,392.4,386.8,375.4,354.9,231.8,101.3,19.4,23.5,25.3,180.7,264.2,232.9,195.7,218.9,100.7,11.9,114.2,8.5,13,54.3,53.7,51.7,54.5,52.3,52.1,52.1,30.1,9.7,283.7,367.2,117.8,10.3,11.7,30,25.7,133.5,16.3,76.3,108.4,38,103.5,33.4,53.4,193.1,82.3,84.3,52,21.1,115.1,40.8,328.1,371.5,312.6,391.1,390.3,444.1,401,214.9,217.3,240.2,230.3,55.1,17.6,13,10.5,10.2,15.2,54.6,54.8,55.8,54.6,143.3,54.1,56.1,33.2,10.7,262.3,288.3,174.6,62,138.5,79.6,199.4,51.8,49.9,105.6,214.9,234.8,65.4,13,22.8,17.4,151.6,157.3,78,19.7,26,137.6,15.7,13.8,11.8,59.5,234.8,280.7,230.1,215.9,392.8,399.1,296.2,98.4,28.4,9.6,9.2,8.8,14.4,54.8,53.7,53.7,54,54.6,54.4,147,39.9,14.7,186.9,112.6,204,75.3,16.8,14.2,36.5,93.4,125.7,73.3,23.8,18.5,27.8,21.6,30.3,61.6,67.7,16.2,25.6,19.8,51.6,220.9,143.7,325.9,277.7,204.1,197.1,194.1,174.3,186.7,53.6,32.9,24.5,26.6,86.3,15.5,24.9,10.4,13.7,53.5,54.3,139.8,55.8,55.5,55,54.2,32.8,9.9,23,101.3,215,70.2,23.1,16.5,181.6,168.4,216.6,176.9,47,10.5,10.2,52.3,91.8,51.4,152,100.4,64.7,29,37.5,59.5,53.2,119,97.8,175.1,142.7,143.1,111.1,62,20.2,24.7,172.9,54.8,19.5,11.4,12.1,11,15.2,55.9,55.4,54.1,53.9,54.9,54.9,55.2,33.1,10.1,122.5,37.4,230.9,168.8,17.4,17.3,17.3,17.3,28.9,18.4,27.3,18,19,20.3,31,166.1,97.1,222.9,50.5,98.6,21.8,17.1,150,108.8,344.1,364.8,245.3,252,222,245.3,226.7,28.2,53.7,39.2,18,112.3,30.9,12,13.6,54.2,52.6,52.8,53.1,54.7,54.4,54.9,30.7,8.4,9.7,9.8,9.8,21.5,17.5,141,238.5,189.2,164.3,28,28,156.2,246.9,98.9,96.1,104.2,59.9,199.5,205.4,275.2,234.9,430.3,130.3,81.8,62.1,100.5,248.8,253.7,297.7,216.1,60.7,197.3,178.9,57,21.6,15.4,11.9,10.1,106.7,54.6,55.7,54.3,55.1,53.7,54.1,54.1,31.3,9.5,8.5,8.1,13.6,30.2,43.1,64.7,63,114.3,119.6,17,16.1,32.5,44.4,204.8,53.8,31.9,21.5,29.8,15.3,9.7,8.4,8.4,24.2,187.9,277.2,376.2,368.2,192.3,198.2,134,27.1,90.9,52.6,105,138.3,78.4,103.3,32.1,15.4,55.4,55.1,55.2,55.5,55.4,56.5,56.3,32.9,10.2,227,240.9,34,15.9,9.9,18.5,36.7,179.3,216.7,12,11.3,151.2,210.9,120.8,44,10.9,10.7,10.6,85.6,114.7,25.4,114.1,80,291.5,262.1,242.1,280.1,312.3,441.4,288.1,385.6,261,131.9,19,21.4,53.5,14,12.6,18.2,58.8,56.3,53.3,53.1,53.4,130.4,61.2,30.2,7.8,275.1,351.8,212.5,48.8,24.7,9.5,8.6,8.7,9.7,14.8,133.7,17.7,27.4]">
            <input type="hidden" id="hidden_load_annual_energy" data-pysam-key="load_annual_energy" value="10000">
            <input type="hidden" id="hidden_load_type" data-pysam-key="load_type" value="residential">

            <!-- PySAM Grid Configuration Hidden Fields -->
            <input type="hidden" id="hidden_enable_interconnection_limit" data-pysam-key="grid.enable_interconnection_limit" value="yes">
            <input type="hidden" id="hidden_grid_interconnection_limit_kwac" data-pysam-key="grid.grid_interconnection_limit_kwac" value="">
            <input type="hidden" id="hidden_load_escalation" data-pysam-key="grid.load_escalation" value="2">
            <input type="hidden" id="hidden_load_step" data-pysam-key="grid.load_step" value="1">
            <input type="hidden" id="hidden_load_peak" data-pysam-key="grid.load_peak" value="">
            <input type="hidden" id="hidden_annual_energy" data-pysam-key="grid.annual_energy" value="726208">
        </div>
    </div></div></div></div>

            <!-- Form Actions with FCAS Revenue Display and Dashboard Integration -->
            <div class="row">
                <div class="col-12">
                    <div class="d-flex justify-content-between align-items-center p-4 bg-white rounded-3 shadow-sm">
                        <!-- SIMPLIFIED Form Status - NO PERCENTAGES -->
                        <div class="d-flex align-items-center">
                            <div class="me-3">
                                <i class="fas fa-tasks text-primary me-2"></i>
                                <span class="text-muted small">Form Status</span>
                            </div>
                            <span class="text-muted small">Ready</span>
                        </div>

                        <!-- Action Buttons -->
                        <div class="d-flex gap-2">
                            
                            <button type="button" class="btn btn-outline-secondary" id="save-draft-btn">
                                <i class="fas fa-save me-2"></i>
                                Save Draft
                            </button>

                            <button type="button" class="btn btn-outline-primary" id="validate-form-btn">
                                <i class="fas fa-check-circle me-2"></i>
                                Validate
                            </button>

                            <div class="dropdown">
                                <button class="btn btn-outline-info dropdown-toggle" type="button" id="previewDropdown" data-bs-toggle="dropdown">
                                    <i class="fas fa-eye me-2"></i>Preview
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" id="preview-config">
                                        <i class="fas fa-cog me-2"></i>Configuration Summary
                                    </a></li>
                                    <li><a class="dropdown-item" href="#" id="preview-fcas">
                                        <i class="fas fa-bolt me-2"></i>FCAS Settings
                                    </a></li>
                                    <li><a class="dropdown-item" href="#" id="preview-tariff">
                                        <i class="fas fa-plug me-2"></i>Tariff Settings
                                    </a></li>
                                    <li><a class="dropdown-item" href="#" id="preview-load">
                                        <i class="fas fa-chart-line me-2"></i>Load Profile
                                    </a></li>
                                </ul>
                            </div>
                            

                            <button type="submit" class="btn btn-primary px-4" id="run-analysis-btn" disabled=""><i class="fas fa-spinner fa-spin me-2"></i>Processing...</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>

        <!-- Analysis Success Notification with Dashboard Link -->
        <div class="success-with-dashboard" id="analysis-success-banner" style="display: none;">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h5 class="mb-2">
                        <i class="fas fa-check-circle me-2"></i>
                        Analysis Completed Successfully!
                    </h5>
                    <p class="mb-0">
                        Your energy system analysis has been completed with enhanced FCAS revenue forecasting.
                        <span id="success-fcas-summary"></span>
                    </p>
                </div>
                <div class="col-md-4 text-end">
                    <a href="/dashboard/" class="btn btn-light btn-lg">
                        <i class="fas fa-chart-line me-2"></i>
                        View Results Dashboard
                    </a>
                </div>
            </div>
        </div>
    </main>

    <!-- Configuration Preview Modal -->
    <div class="modal fade" id="configPreviewModal" tabindex="-1" aria-labelledby="configPreviewTitle" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="configPreviewTitle">
                        <i class="fas fa-eye me-2"></i>
                        Configuration Preview
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="configPreviewContent">
                        <!-- Content will be populated by JavaScript -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Close
                    </button>
                    <button type="button" class="btn btn-primary" onclick="exportConfiguration()">
                        <i class="fas fa-download me-2"></i>Export Configuration
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Load Data Upload Modal -->
    <div class="modal fade" id="loadUploadModal" tabindex="-1" aria-labelledby="loadUploadTitle" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loadUploadTitle">
                        <i class="fas fa-upload me-2"></i>Upload Load Data
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="load-upload-content">
                        <!-- Content will be populated by JavaScript -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancel
                    </button>
                    <button type="button" class="btn btn-primary" id="confirm-load-upload" disabled="">
                        <i class="fas fa-check me-2"></i>Use This Data
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notification-container" class="position-fixed top-0 end-0 p-3" style="z-index: 9999;">
        <!-- Notifications will be inserted here -->
    </div>

    <!-- Footer -->
    <footer class="bg-white border-top py-4 mt-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-leaf text-success me-2"></i>
                        <span class="text-muted">Powered by EnTrans Energy Solutions</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="text-end text-muted small">
                        <span class="me-3">
                            <i class="fas fa-brain me-1"></i>
                            ML-Enhanced FCAS Forecasting
                        </span>
                        <span class="me-3">
                            <i class="fas fa-lock me-1"></i>
                            Secure &amp; Confidential
                        </span>
                        <span>
                            <i class="fas fa-clock me-1"></i>
                            Session: <span id="session-timer">00:59</span>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <!-- Bootstrap 5.3 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <!-- Chart.js for load visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Enhanced Form Script with FCAS Integration -->
    <script src="/static/js/tariff_v4.js"></script>

    <!-- PRODUCTION-READY: Core Application JavaScript -->
    <script>
        // Global configuration and state management
        const restoredValues = {};
        const isRestoration = false;

        // Application state
        let autoPollingInterval;
        let isAutoPolling = false;
        let sessionStart = Date.now();
        let submissionTimeout;

        // DOM element cache for performance
        const domCache = {
            form: null,
            submitBtn: null,
            progressDiv: null,

            init() {
                this.form = document.getElementById('analysis-form');
                this.submitBtn = document.getElementById('run-analysis-btn');
                this.progressDiv = document.getElementById('analysis-progress');
            }
        };

        // ========== PRODUCTION: FORM DATA PERSISTENCE (PRESERVED) ==========
        function persistFormValuesToHTML() {
            const form = domCache.form || document.getElementById('analysis-form');
            if (!form) {
                console.error('Form not found for persistence');
                return false;
            }

            try {
                let persistedCount = 0;
                const allElements = form.querySelectorAll('input, select, textarea');

                allElements.forEach(element => {
                    try {
                        const elementType = element.type || element.tagName.toLowerCase();

                        if (elementType === 'checkbox') {
                            if (element.checked) {
                                element.setAttribute('checked', 'checked');
                            } else {
                                element.removeAttribute('checked');
                            }
                            persistedCount++;

                        } else if (elementType === 'radio') {
                            if (element.checked) {
                                element.setAttribute('checked', 'checked');
                            } else {
                                element.removeAttribute('checked');
                            }
                            persistedCount++;

                        } else if (element.tagName.toLowerCase() === 'select') {
                            const currentValue = element.value;
                            element.setAttribute('value', currentValue);

                            Array.from(element.options).forEach(option => {
                                if (option.value === currentValue) {
                                    option.setAttribute('selected', 'selected');
                                } else {
                                    option.removeAttribute('selected');
                                }
                            });
                            persistedCount++;

                        } else {
                            const currentValue = element.value;
                            element.setAttribute('value', currentValue);
                            persistedCount++;
                        }

                    } catch (error) {
                        // Continue processing other elements
                    }
                });

                return persistedCount > 0;
            } catch (error) {
                console.error('Form persistence failed:', error.message);
                return false;
            }
        }

        // ========== PRODUCTION: FORM DATA COLLECTION (PRESERVED) ==========
        function collectFormData() {
            const formData = {};
            const form = domCache.form || document.getElementById('analysis-form');

            if (!form) {
                console.error('Form not found for data collection');
                return formData;
            }

            try {
                // Method 1: Get all form elements with names
                const namedElements = form.querySelectorAll('[name]');
                namedElements.forEach(element => {
                    const name = element.getAttribute('name');
                    if (name) {
                        if (element.type === 'checkbox') {
                            formData[name] = element.checked;
                        } else if (element.type === 'radio') {
                            if (element.checked) {
                                formData[name] = element.value;
                            }
                        } else {
                            formData[name] = element.value;
                        }
                    }
                });

                // Method 2: Get all elements with data-pysam-key attributes
                const pysamElements = form.querySelectorAll('[data-pysam-key]');
                pysamElements.forEach(element => {
                    const key = element.getAttribute('data-pysam-key');
                    if (key) {
                        if (element.type === 'checkbox') {
                            formData[key] = element.checked;
                        } else if (element.type === 'radio') {
                            if (element.checked) {
                                formData[key] = element.value;
                            }
                        } else {
                            formData[key] = element.value;
                        }
                    }
                });

                // Method 3: Get all input, select, textarea elements by ID
                const allInputs = form.querySelectorAll('input, select, textarea');
                allInputs.forEach(element => {
                    if (element.id) {
                        if (element.type === 'checkbox') {
                            formData[element.id] = element.checked;
                        } else if (element.type === 'radio') {
                            if (element.checked) {
                                formData[element.id] = element.value;
                            }
                        } else if (element.value !== '') {
                            formData[element.id] = element.value;
                        }
                    }
                });

                // Method 4: Collect load configuration data
                if (window.loadDataManager && window.loadDataManager.getFormData) {
                    const loadData = window.loadDataManager.getFormData();
                    Object.assign(formData, loadData);
                }

                return formData;
            } catch (error) {
                console.error('Form data collection failed:', error.message);
                return {};
            }
        }

        // ========== PRODUCTION: ENHANCED FORM SUBMISSION WITH CACHE CLEARING ==========
        function handleFormSubmission(e) {
            e.preventDefault();

            const submitBtn = document.getElementById('run-analysis-btn');
            if (!submitBtn || submitBtn.disabled) return false;

            // Disable submit button
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Processing...';

            try {
                // Persist form values
                const persistSuccess = persistFormValuesToHTML();
                if (!persistSuccess) {
                    throw new Error('Failed to persist form values');
                }

                // Collect and submit form data
                const formData = collectFormData();
                const submitData = {
                    form_html: document.documentElement.outerHTML,
                    form_data: formData
                };

                fetch('/run-analysis', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(submitData)
                })
                .then(response => response.json())
                .then(result => {
                    if (result.status === 'started') {
                        showNotification('Analysis started successfully', 'success');
                        setTimeout(() => startAutoPolling(), 2000);
                    } else {
                        throw new Error(result.error || 'Analysis failed to start');
                    }
                })
                .catch(error => {
                    showNotification('Unable to submit analysis. Please try again.', 'error');
                    resetSubmitButton();
                });

            } catch (error) {
                showNotification('Submission failed. Please try again.', 'error');
                resetSubmitButton();
            }
        }

        // Update the autoPollingFunction to use cache-busted requests
        function autoPollingFunction() {
            fetch('/analysis-status')
                .then(r => {
                    if (!r.ok) throw new Error(`Status check failed: ${r.status}`);
                    return r.json();
                })
                .then(data => {
                    updateSimpleStatus(data);

                    if (!data.running || data.stage === 'completed') {
                        stopAutoPolling();
                        showCompletionUI(data);
                    } else if (data.stage === 'failed') {
                        stopAutoPolling();
                        showFailureUI(data);
                    }
                })
                .catch(err => {
                    // Continue polling on network errors
                });
        }

        // ========== PRODUCTION: UTILITY FUNCTIONS ==========
        function resetSubmitButton() {
            const submitBtn = domCache.submitBtn || document.getElementById('run-analysis-btn');
            if (submitBtn) {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-play-circle me-2"></i>Run Analysis';
            }
        }

        function validateEnvironment() {
            if (typeof fetch === 'undefined') {
                console.error('Fetch API not supported');
                showNotification('Your browser is not supported. Please update or use a modern browser.', 'error');
                return false;
            }
            return true;
        }

        // ========== PRODUCTION: SIMPLIFIED PROGRESS TRACKING ==========
        function startAutoPolling() {
            if (isAutoPolling) return;

            isAutoPolling = true;
            let pollCount = 0;
            const maxPolls = 200; // 10 minutes at 3-second intervals

            const progressDiv = domCache.progressDiv || document.getElementById('analysis-progress');
            if (progressDiv) progressDiv.classList.add('show');

            autoPollingInterval = setInterval(() => {
                pollCount++;

                if (pollCount > maxPolls) {
                    console.error('Analysis polling timeout');
                    stopAutoPolling();
                    showNotification('Analysis is taking longer than expected. Please check the dashboard.', 'warning');
                    return;
                }

                autoPollingFunction();
            }, 3000);

            autoPollingFunction();
        }

        function updateSimpleStatus(data) {
            const progressMsg = document.getElementById('progress-message');
            const progressTitle = document.getElementById('progress-title');

            if (progressMsg) {
                progressMsg.textContent = data.message || 'Processing...';
            }

            if (progressTitle) {
                const titles = {
                    'initializing': 'Starting...',
                    'form_integration': 'Processing...',
                    'pysam_simulation': 'Running Simulation...',
                    'results_compilation': 'Finalizing...',
                    'completed': 'Complete!',
                    'failed': 'Failed'
                };
                progressTitle.textContent = titles[data.stage] || 'Processing...';
            }
        }

        function stopAutoPolling() {
            isAutoPolling = false;
            if (autoPollingInterval) {
                clearInterval(autoPollingInterval);
                autoPollingInterval = null;
            }
        }

        function showCompletionUI(data) {
            const progressDiv = domCache.progressDiv || document.getElementById('analysis-progress');
            if (progressDiv) progressDiv.classList.remove('show');

            const successBanner = document.getElementById('analysis-success-banner');
            if (successBanner) successBanner.style.display = 'block';

            showNotification('Analysis completed! Redirecting to dashboard...', 'success');

            setTimeout(() => {
                window.location.href = '/dashboard/';
            }, 3000);
        }

        function showFailureUI(data) {
            const progressDiv = domCache.progressDiv || document.getElementById('analysis-progress');
            if (progressDiv) progressDiv.classList.remove('show');

            const errorMessage = data.error || 'Analysis failed. Please try again.';
            showNotification(`Analysis failed: ${errorMessage}`, 'error');
            resetSubmitButton();
        }

        function checkForRunningAnalysis() {
            fetch('/analysis-status')
                .then(r => r.json())
                .then(data => {
                    if (data.running) {
                        startAutoPolling();
                    }
                })
                .catch(() => {
                    // No analysis running
                });
        }

        // ========== PRODUCTION: INITIALIZATION ==========
        document.addEventListener('DOMContentLoaded', function() {
            if (!validateEnvironment()) return;

            // Initialize DOM cache
            domCache.init();

            // Initialize form restoration if needed
            if (isRestoration && Object.keys(restoredValues).length > 0) {
                setTimeout(() => {
                    restoreFormValues(restoredValues);
                }, 1000);
            }

            // Initialize event listeners and functionality
            initializeEventListeners();
            initializeSessionTimer();

            // Hide loading state and initialize components
            setTimeout(() => {
                const loading = document.getElementById('form-loading');
                if (loading) loading.style.display = 'none';
                updateDashboardLink();
                initializeFCAS();
            }, 500);

            // Check for running analysis on page load
            setTimeout(checkForRunningAnalysis, 1000);
        });

        // ========== PRODUCTION: EVENT LISTENERS ==========
        function initializeEventListeners() {
            const form = domCache.form || document.getElementById('analysis-form');
            if (form) {
                form.addEventListener('submit', handleFormSubmission);
            }

            // Configuration preview handlers
            const previewHandlers = [
                { id: 'preview-config', type: 'full' },
                { id: 'preview-fcas', type: 'fcas' },
                { id: 'preview-tariff', type: 'tariff' },
                { id: 'preview-load', type: 'load' }
            ];

            previewHandlers.forEach(handler => {
                const element = document.getElementById(handler.id);
                if (element) {
                    element.addEventListener('click', function(e) {
                        e.preventDefault();
                        showConfigurationPreview(handler.type);
                    });
                }
            });

            // Form validation handler
            const validateBtn = document.getElementById('validate-form-btn');
            if (validateBtn) {
                validateBtn.addEventListener('click', validateForm);
            }

            // Save draft handler (only for new forms)
            if (!isRestoration) {
                const saveDraftBtn = document.getElementById('save-draft-btn');
                if (saveDraftBtn) {
                    saveDraftBtn.addEventListener('click', saveDraft);
                }
                loadSavedDraft();
            }
        }

        // ========== PRODUCTION: SIMPLIFIED FORM PROGRESS ==========
        function updateFormProgress() {
            // Simplified - no calculations needed for production
        }

        // ========== PRODUCTION: FCAS INTEGRATION (PRESERVED) ==========
        function updateFCASIndicators() {
            const fcasEnabled = document.getElementById('fcas-enable')?.checked || false;
            const headerStatus = document.getElementById('header-fcas-status');

            if (headerStatus) {
                if (fcasEnabled) {
                    headerStatus.className = 'fcas-status enabled';
                    headerStatus.innerHTML = '<i class="fas fa-bolt me-1"></i><span>FCAS Active</span>';
                } else {
                    headerStatus.className = 'fcas-status disabled';
                    headerStatus.innerHTML = '<i class="fas fa-bolt me-1"></i><span>FCAS Disabled</span>';
                }
            }
        }

        function initializeFCAS() {
            const fcasEnableCheckbox = document.getElementById('fcas-enable');
            if (fcasEnableCheckbox) {
                fcasEnableCheckbox.addEventListener('change', function(e) {
                    updateFCASIndicators();
                });
            }
            updateFCASIndicators();
        }

        // ========== PRODUCTION: FORM RESTORATION (PRESERVED) ==========
        function restoreFormValues(values) {
            Object.entries(values).forEach(([key, value]) => {
                const element = document.getElementById(key) || document.querySelector(`[name="${key}"]`);

                if (element) {
                    if (element.type === 'checkbox') {
                        element.checked = value === true || value === 'true' || value === 'on';
                    } else if (element.type === 'radio') {
                        if (element.value === value) {
                            element.checked = true;
                        }
                    } else if (element.tagName === 'SELECT') {
                        const option = element.querySelector(`option[value="${value}"]`);
                        if (option) {
                            element.value = value;
                        }
                    } else {
                        element.value = value;
                    }

                    element.dispatchEvent(new Event('change', { bubbles: true }));
                    element.dispatchEvent(new Event('input', { bubbles: true }));
                }
            });

            // Special handling for FCAS configuration
            if (values['fcas-enable'] || values['fcas_enable']) {
                setTimeout(() => {
                    if (typeof updateFCASIndicators === 'function') {
                        updateFCASIndicators();
                    }
                }, 500);
            }
        }

        // ========== PRODUCTION: CONFIGURATION PREVIEW ==========
        function showConfigurationPreview(type) {
            const modal = new bootstrap.Modal(document.getElementById('configPreviewModal'));
            const content = document.getElementById('configPreviewContent');
            const title = document.getElementById('configPreviewTitle');

            let previewHTML = '';

            switch(type) {
                case 'fcas':
                    title.innerHTML = '<i class="fas fa-bolt me-2"></i>FCAS Configuration Preview';
                    previewHTML = generateFCASPreview();
                    break;
                case 'tariff':
                    title.innerHTML = '<i class="fas fa-plug me-2"></i>Tariff Configuration Preview';
                    previewHTML = generateTariffPreview();
                    break;
                case 'load':
                    title.innerHTML = '<i class="fas fa-chart-line me-2"></i>Load Profile Preview';
                    previewHTML = generateLoadPreview();
                    break;
                default:
                    title.innerHTML = '<i class="fas fa-eye me-2"></i>Full Configuration Preview';
                    previewHTML = generateFullPreview();
            }

            content.innerHTML = previewHTML;
            modal.show();
        }

        function generateFCASPreview() {
            const fcasEnabled = document.getElementById('fcas-enable')?.checked || false;

            return `
                <div class="row">
                    <div class="col-md-6">
                        <h6>FCAS Configuration</h6>
                        <table class="table table-sm">
                            <tr><td><strong>Status:</strong></td><td>${fcasEnabled ? 'Enabled' : 'Disabled'}</td></tr>
                            <tr><td><strong>Note:</strong></td><td>Configure FCAS settings in Financial Parameters tab</td></tr>
                        </table>
                    </div>
                    <div class="col-md-6">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            FCAS configuration is handled in the Financial Parameters section of the form.
                        </div>
                    </div>
                </div>
            `;
        }

        function generateTariffPreview() {
            const tariffType = document.getElementById('tariff-type-select')?.value || 'Flat';
            const fixedCharge = document.getElementById('monthly-fixed-charge')?.value || '10.00';
            const feedInTariff = document.getElementById('feed-in-tariff')?.value || '0.05';

            return `
                <div class="row">
                    <div class="col-md-6">
                        <h6>Tariff Configuration</h6>
                        <table class="table table-sm">
                            <tr><td><strong>Tariff Type:</strong></td><td>${tariffType}</td></tr>
                            <tr><td><strong>Monthly Fixed Charge:</strong></td><td>${fixedCharge}</td></tr>
                            <tr><td><strong>Feed-in Tariff:</strong></td><td>${feedInTariff}/kWh</td></tr>
                        </table>
                    </div>
                    <div class="col-md-6">
                        <h6>Rate Details</h6>
                        ${tariffType === 'Flat' ?
                            `<p>Flat Rate: ${document.getElementById('flat-rate')?.value || '0.12'}/kWh</p>` :
                            '<p>Time-of-Use rates configured</p>'
                        }
                    </div>
                </div>
            `;
        }

        function generateLoadPreview() {
            const loadMethod = window.loadDataManager?.getCurrentMethod() || 'auto';
            const loadSummary = window.loadDataManager?.getSummary() || 'No load data configured';

            return `
                <div class="row">
                    <div class="col-md-12">
                        <h6>Load Configuration</h6>
                        <table class="table table-sm">
                            <tr><td><strong>Method:</strong></td><td>${loadMethod}</td></tr>
                            <tr><td><strong>Summary:</strong></td><td>${loadSummary}</td></tr>
                        </table>
                        ${window.loadDataManager?.hasChart() ?
                            '<div class="mt-3"><canvas id="preview-load-chart" width="400" height="200"></canvas></div>' :
                            '<div class="alert alert-info mt-3">No load chart available</div>'
                        }
                    </div>
                </div>
            `;
        }

        function generateFullPreview() {
            return `
                <div class="row">
                    <div class="col-12">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            Full configuration preview includes form data, FCAS settings, tariff configuration, and load profile.
                            <hr>
                            <div class="row">
                                <div class="col-md-4">
                                    ${generateFCASPreview()}
                                </div>
                                <div class="col-md-4">
                                    ${generateTariffPreview()}
                                </div>
                                <div class="col-md-4">
                                    ${generateLoadPreview()}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function exportConfiguration() {
            showNotification('Export functionality ready - configuration will be downloaded.', 'info');
        }

        // ========== PRODUCTION: FORM VALIDATION & DRAFT MANAGEMENT ==========
        function validateForm() {
            const form = domCache.form || document.getElementById('analysis-form');

            if (form.checkValidity()) {
                showNotification('Form validation passed! All required fields are completed.', 'success');
            } else {
                form.classList.add('was-validated');
                showNotification('Please complete all required fields before proceeding.', 'warning');

                const firstInvalid = form.querySelector(':invalid');
                if (firstInvalid) {
                    firstInvalid.focus();
                    firstInvalid.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        }

        function saveDraft() {
            try {
                const formData = new FormData(domCache.form || document.getElementById('analysis-form'));
                const draftData = Object.fromEntries(formData);

                localStorage.setItem('entrans_form_draft', JSON.stringify(draftData));
                showNotification('Draft saved successfully!', 'success');
            } catch (error) {
                showNotification('Failed to save draft', 'error');
            }
        }

        function loadSavedDraft() {
            try {
                const savedDraft = localStorage.getItem('entrans_form_draft');
                if (savedDraft) {
                    const draftData = JSON.parse(savedDraft);
                    showNotification('Previous draft found. Would you like to restore it?', 'info', true);
                }
            } catch (error) {
                // Ignore invalid draft data
            }
        }

        // ========== PRODUCTION: UTILITY FUNCTIONS ==========
        function updateDashboardLink() {
            const dashboardLink = document.getElementById('dashboard-link');
            if (dashboardLink) {
                dashboardLink.classList.remove('disabled');
            }
        }

        function initializeSessionTimer() {
            setInterval(() => {
                const elapsed = Math.floor((Date.now() - sessionStart) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                const timer = document.getElementById('session-timer');
                if (timer) {
                    timer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
            }, 1000);
        }

        function showNotification(message, type = 'info', persistent = false) {
            let container = document.getElementById('notification-container');
            if (!container) {
                container = document.createElement('div');
                container.id = 'notification-container';
                container.className = 'position-fixed top-0 end-0 p-3';
                container.style.zIndex = '9999';
                document.body.appendChild(container);
            }

            const notification = document.createElement('div');
            notification.className = `alert alert-${type === 'error' ? 'danger' : type} alert-dismissible fade show`;
            notification.style.cssText = 'min-width: 300px; margin-bottom: 0.5rem;';

            const icon = {
                'success': 'fas fa-check-circle',
                'warning': 'fas fa-exclamation-triangle',
                'error': 'fas fa-times-circle',
                'info': 'fas fa-info-circle'
            }[type] || 'fas fa-info-circle';

            notification.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="${icon} me-2"></i>
                    <div class="flex-grow-1">${message}</div>
                    ${!persistent ? '<button type="button" class="btn-close" data-bs-dismiss="alert"></button>' : ''}
                </div>
            `;

            container.appendChild(notification);

            if (!persistent) {
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 5000);
            }
        }

        // ========== PRODUCTION: GLOBAL FUNCTION EXPORTS ==========
        // Essential functions for external scripts
        window.updateFCASIndicators = updateFCASIndicators;
        window.updateFormProgress = updateFormProgress;
        window.showNotification = showNotification;
        window.exportConfiguration = exportConfiguration;
        window.persistFormValuesToHTML = persistFormValuesToHTML;
        window.collectFormData = collectFormData;
    </script>

<div class="progress-indicator" style="transform: scaleX(1);"></div></body></html>